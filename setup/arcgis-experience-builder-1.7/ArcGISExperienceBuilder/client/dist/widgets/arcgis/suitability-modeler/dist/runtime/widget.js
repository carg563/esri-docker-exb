System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/widgets/support/chartUtils","esri/layers/GraphicsLayer","esri/geometry/Polygon","esri/request","esri/portal/PortalItem","esri/widgets/Sketch/SketchViewModel","esri/portal/Portal","esri/layers/ImageryLayer","esri/layers/support/RasterFunction","esri/core/watchUtils"],(function(e,l){var t={},a={},r={},o={},n={},i={},s={},u={},c={},d={},g={},h={},p={};return{setters:[function(e){t.React=e.React,t.classNames=e.classNames,t.css=e.css,t.jsx=e.jsx},function(e){a.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.AlertPopup=e.AlertPopup,r.Button=e.Button,r.ButtonGroup=e.ButtonGroup,r.Checkbox=e.Checkbox,r.Dropdown=e.Dropdown,r.DropdownButton=e.DropdownButton,r.DropdownItem=e.DropdownItem,r.DropdownMenu=e.DropdownMenu,r.Form=e.Form,r.FormGroup=e.FormGroup,r.Icon=e.Icon,r.Label=e.Label,r.NumericInput=e.NumericInput,r.Select=e.Select,r.Slider=e.Slider,r.Tab=e.Tab,r.Tabs=e.Tabs,r.TextArea=e.TextArea,r.TextInput=e.TextInput},function(e){o.default=e.default},function(e){n.default=e.default},function(e){i.default=e.default},function(e){s.default=e.default},function(e){u.default=e.default},function(e){c.default=e.default},function(e){d.default=e.default},function(e){g.default=e.default},function(e){h.default=e.default},function(e){p.default=e.default}],execute:function(){e((()=>{var e={51623:(e,l,t)=>{"use strict";t.d(l,{Z:()=>i});var a=t(8081),r=t.n(a),o=t(23645),n=t.n(o)()(r());n.push([e.id,".widget-wro{padding:0px;width:100%;height:100%;background-color:var(--white)}.widget-wro-loading-msg{margin:4px 6px}.widget-wro-loading-error-msg{margin:4px 6px;font-style:italic}.widget-wro-modeler{display:flex;flex-direction:column;width:100%;height:100%}.widget-wro-header{margin:10px 10px 5px;font-weight:bold}.widget-wro-body{flex:1 1 auto;overflow:hidden}.widget-wro-tabs{width:100%;height:100%}.widget-wro-tabs>.tab-nav{border-bottom:none}.widget-wro-tabs>.tab-content{width:100%;height:calc(100% - 71px)}.widget-wro-tabs .nav-item{width:33.33%;height:70px}.widget-wro-tabs .nav-item .nav-link.jimu-btn{display:flex;flex-direction:column;justify-content:space-around;padding-left:0.5rem;padding-right:0.5rem;position:relative;border:none !important}.widget-wro-tabs .nav-item .jimu-link:before{width:24px;height:24px;border-radius:50px;z-index:1;color:var(--primary-500);background-color:var(--white);border:2px solid var(--primary-500)}.widget-wro-tabs .nav-item .jimu-link.active:before{background-color:var(--primary-500);color:var(--white);border-color:var(--primary-500)}.widget-wro-tabs .nav-item .jimu-link.disabled:before{background-color:var(--light-100);color:var(--light-800);border-color:var(--light-400)}.widget-wro-tabs .nav-item:first-of-type .jimu-link:before{content:'1'}.widget-wro-tabs .nav-item:nth-of-type(2) .jimu-link:before{content:'2'}.widget-wro-tabs .nav-item:nth-of-type(3) .jimu-link:before{content:'3'}.widget-wro-tabs .nav-item .jimu-link:after{content:' ';width:100%;height:3px;background:var(--primary-500);position:absolute;top:20px;z-index:0}.widget-wro-tabs .nav-item .jimu-link.active:after{background:var(--primary-500)}.widget-wro-tabs .nav-item .jimu-link.disabled:after{background:var(--light-400)}.widget-wro-tabs .nav-item .jimu-link.disabled{cursor:not-allowed}.widget-wro-tabs .nav-item .tab-title{color:var(--black)}.widget-wro-tabs .nav-item .jimu-link.disabled .tab-title{color:var(--light-600)}.widget-wro-layers-panel,.widget-wro-model-panel,.widget-wro-chart-panel{width:100%;height:100%}.widget-wro-panel-header{padding:10px;font-size:14px;font-weight:bold;line-height:32px;height:52px}.widget-wro-layers-panel{display:flex;flex-direction:column;width:100%;height:100%}.widget-wro-layers-body{flex:1 1 auto;display:flex;flex-direction:column;width:100%;height:100%;overflow:auto}.widget-wro-layers-list{flex:1 1 auto;margin:0;padding:10px;padding-top:4px;list-style-type:none;overflow:auto}.widget-wro-layers-buttons{padding:1rem 0rem;display:flex;flex-direction:row-reverse;justify-content:space-between}.widget-wro-nav-buttons{padding:0.5rem 0rem 1rem;display:flex;flex-direction:row-reverse;justify-content:space-between;width:100%}.widget-wro-layers-buttons .btn-group,.widget-wro-layers-buttons .btn-group .btn{width:100%}.widget-wro-layers-buttons .btn-group .btn svg{margin-left:0.5rem;margin-right:0.5rem;vertical-align:middle}.widget-wro-nav-btn{display:flex;align-items:center}.widget-wro-nav-btn.jimu-btn .jimu-icon{margin:0px 6px}.widget-wro-layer-title{margin:0 8px}.widget-wro-model-panel{display:flex;flex-direction:column;width:100%;height:100%}.widget-wro-model-panel-body{flex:1 1 auto;display:flex;flex-direction:column;width:100%;height:100%;overflow:auto}.widget-wro-model-layers-list{flex:1 1 auto;margin:0;padding:0px;padding-top:4px;list-style-type:none;overflow:auto}.widget-wro-model-item{display:flex;align-items:center;justify-content:space-between;margin:6px 10px}.widget-wro-model-item-label{display:flex}.widget-wro-model-item-input-section{display:flex;align-items:center;margin:0 0.3rem}.widget-wro-model-item-remap-btn{margin:0 6px}.widget-wro-model-item-percent{display:inline-block;width:1rem;text-align:center}.widget-wro-model-total{padding:10px;display:flex;justify-content:space-between;font-weight:bold;border-top:1px solid var(--dark-100);border-bottom:1px solid var(--dark-100)}.widget-wro-model-buttons{padding:1rem}.widget-wro-model-buttons .btn-group{width:100%;display:flex;justify-content:flex-end}.widget-wro-model-buttons .btn-group .btn{width:33%;margin-left:6px;margin-right:6px}.widget-wro-input-weight{width:2.6rem}.widget-wro-remap-panel{background-color:var(--light-300);padding:8px 18px;position:relative}.widget-wro-remap-panel:after{content:\"\";width:0px;height:0px;position:absolute;top:-10px;right:86px;border:5px solid transparent;border-bottom-color:var(--light-300)}.jimu-rtl .widget-wro-remap-panel:after{right:auto;left:86px}.widget-wro-remap-range{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}.widget-wro-remap-range:last-of-type{margin-bottom:0px}.widget-wro-remap-slider{display:inline-block;width:120px}.widget-wro-remap-numeric-input{display:inline-block;width:26px;margin:0 6px;text-align:right}.widget-wro-remap-numeric-input .jimu-numeric-input-input{width:26px}.widget-wro-color-dropdown-menu{max-height:300px;overflow-y:auto}.widget-wro-color-ramp{display:block;font-size:13px;font-weight:400}.widget-wro-color-ramp .widget-wro-color-ramp-colors{margin-left:2px;margin-right:2px}.widget-wro-color-ramp .widget-wro-color-ramp-color{display:inline-block;width:5px;height:8px;margin-bottom:2px}.widget-wro-flex-between{display:flex;justify-content:space-between;align-items:center}.widget-wro-flex-column{display:flex;flex-direction:column}.widget-wro-chart-panel{display:flex;flex-direction:column;width:100%;height:100%}.widget-wro-chart-header{padding:10px;font-size:14px;font-weight:bold;line-height:32px}.widget-wro-chart-body{flex:1 1 auto;display:flex;flex-direction:column;width:100%;height:100%;overflow:auto;padding:10px}.widget-wro-chart-tools{white-space:nowrap}.widget-wro-chart-button{margin-left:0.2rem !important;margin-right:0.2rem !important;text-decoration:none !important}.widget-wro-chart-select-layer-section{font-weight:normal;margin-top:10px;height:2rem;text-align:center}.widget-wro-chart-note{font-style:italic}.widget-wro-model-working,.widget-wro-chart-working{margin-top:0.4rem;font-weight:normal;font-size:smaller;height:0.8rem;text-align:center}.widget-wro-chart-warning{margin-top:0.4rem;font-weight:normal;font-style:italic;height:0.8rem;text-align:center}.widget-wro-model-working{margin-top:2px}.widget-wro-chart-component{width:100%;height:100%}.widget-wro-chart-buttons{padding:1rem 0rem;display:flex;justify-content:space-between}.widget-wro-export-popup .modal-content{min-width:400px;margin-bottom:200px}.widget-wro-export-popup.widget-wro-invalid-modal .modal-footer .btn-primary{color:var(--light-800);background-color:var(--light-200);border-color:var(--light-200);box-shadow:none;pointer-events:none}.widget-wro-form textarea{height:4rem}.widget-wro-fadein{animation:widget-wro-kf-fadein 10s}@keyframes widget-wro-kf-fadein{0%{opacity:0}100%{opacity:1}}@keyframes widget-wro-kf-spinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}\n",""]);const i=n},23645:e=>{"use strict";e.exports=function(e){var l=[];return l.toString=function(){return this.map((function(l){var t="",a=void 0!==l[5];return l[4]&&(t+="@supports (".concat(l[4],") {")),l[2]&&(t+="@media ".concat(l[2]," {")),a&&(t+="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {")),t+=e(l),a&&(t+="}"),l[2]&&(t+="}"),l[4]&&(t+="}"),t})).join("")},l.i=function(e,t,a,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var n={};if(a)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(n[s]=!0)}for(var u=0;u<e.length;u++){var c=[].concat(e[u]);a&&n[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),t&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=t):c[2]=t),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),l.push(c))}},l}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},93379:e=>{"use strict";var l=[];function t(e){for(var t=-1,a=0;a<l.length;a++)if(l[a].identifier===e){t=a;break}return t}function a(e,a){for(var o={},n=[],i=0;i<e.length;i++){var s=e[i],u=a.base?s[0]+a.base:s[0],c=o[u]||0,d="".concat(u," ").concat(c);o[u]=c+1;var g=t(d),h={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==g)l[g].references++,l[g].updater(h);else{var p=r(h,a);a.byIndex=i,l.splice(i,0,{identifier:d,updater:p,references:1})}n.push(d)}return n}function r(e,l){var t=l.domAPI(l);return t.update(e),function(l){if(l){if(l.css===e.css&&l.media===e.media&&l.sourceMap===e.sourceMap&&l.supports===e.supports&&l.layer===e.layer)return;t.update(e=l)}else t.remove()}}e.exports=function(e,r){var o=a(e=e||[],r=r||{});return function(e){e=e||[];for(var n=0;n<o.length;n++){var i=t(o[n]);l[i].references--}for(var s=a(e,r),u=0;u<o.length;u++){var c=t(o[u]);0===l[c].references&&(l[c].updater(),l.splice(c,1))}o=s}}},90569:e=>{"use strict";var l={};e.exports=function(e,t){var a=function(e){if(void 0===l[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}l[e]=t}return l[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}},19216:e=>{"use strict";e.exports=function(e){var l=document.createElement("style");return e.setAttributes(l,e.attributes),e.insert(l,e.options),l}},3565:(e,l,t)=>{"use strict";e.exports=function(e){var l=t.nc;l&&e.setAttribute("nonce",l)}},7795:e=>{"use strict";e.exports=function(e){var l=e.insertStyleElement(e);return{update:function(t){!function(e,l,t){var a="";t.supports&&(a+="@supports (".concat(t.supports,") {")),t.media&&(a+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(a+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),a+=t.css,r&&(a+="}"),t.media&&(a+="}"),t.supports&&(a+="}");var o=t.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),l.styleTagTransform(a,e,l.options)}(l,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(l)}}}},44589:e=>{"use strict";e.exports=function(e,l){if(l.styleSheet)l.styleSheet.cssText=e;else{for(;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(document.createTextNode(e))}}},35384:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 1.914L6.475 2.94a.5.5 0 11-.707-.707L8 0l2.157 2.157a.5.5 0 01-.707.707l-.95-.95V7.5h5.586l-1.1-1.1a.5.5 0 11.706-.708L16 8l-2.232 2.232a.5.5 0 11-.707-.707L14.086 8.5H8.5v5.586l1.025-1.025a.5.5 0 11.707.707L8 16l-2.308-2.308a.5.5 0 11.707-.707l1.101 1.1V8.5H1.914l.95.95a.5.5 0 01-.707.707L0 8l2.232-2.232a.5.5 0 11.707.707L1.914 7.5H7.5V1.914z" fill="#000"></path></svg>'},96314:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1L0 5.5 8 10l8-4.5L8 1zm5.96 7.477l-.606-.341 1.02-.574L16 8.477l-8 4.5-8-4.5 1.627-.915 1.02.574-.607.341L8 11.83l5.96-3.353zm2.04 3l-1.647-.927-1.02.574.627.353L8 14.83l-5.96-3.353.628-.353-1.02-.574L0 11.477l8 4.5 8-4.5zM8 2.148L2.04 5.5 8 8.853 13.96 5.5 8 2.148z" fill="#000"></path></svg>'},32373:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.086 4.35c0-2.794-1.045-4.35-2.865-4.35-1.095 0-2.323.748-3.72 2.204l.69.732.215-.22C6.542 1.584 7.49 1.033 8.221 1.033c1.19 0 1.884 1.032 1.884 3.319 0 .87.35 1.453.997 1.729.358.152.682.199 1.301.207l.787.002c.923.018 1.21.146 1.305.553.207.89-1.364 1.958-4.88 2.98l-.64.179.245.999.325-.09c4.285-1.199 6.313-2.554 5.903-4.313-.232-.997-.788-1.284-2.04-1.333l-.396-.009h-.55c-.518-.005-.772-.038-.99-.131-.266-.114-.386-.312-.386-.773zM.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.91 5.771 1.154-.667-2.91-5.77 2.222-.48-4.893-2.814z" fill="#000"></path></svg>'},36811:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 11V0L6 2.982v2.162h.91l-.001-1.49 8.181-2.44v8.882H8.434V11H16zM.25 3l8.642 4.969-3.422.738 2.723 5.45-2.886 1.667-2.724-5.45-2.351 2.595L.25 3zm.996 1.726l-.01 5.644 1.527-1.684 2.91 5.771 1.154-.667-2.91-5.77 2.222-.48-4.893-2.814z" fill="#000"></path></svg>'},77799:e=>{e.exports='<svg viewBox="0 0 18 16" xmlns="http://www.w3.org/2000/svg"><g fill="#FFF" fill-rule="evenodd"><path d="M7.085 1a1.5 1.5 0 012.83 0H14v1H9.915a1.5 1.5 0 01-2.83 0H0V1h7.085zM1.085 7a1.5 1.5 0 012.83 0H8v1H3.915a1.5 1.5 0 01-2.83 0H0V7h1.085zM3.085 14H0v-1h3.085a1.5 1.5 0 012.83 0H8v1H5.915a1.5 1.5 0 01-2.83 0zM13.987 15.13a.784.784 0 001.06.267l1.444-.845a.793.793 0 00.256-1.125l-.945-1.506 1.13-.321a.8.8 0 00.561-.657.792.792 0 00-.367-.78L11.72 6.63a.777.777 0 00-.822-.023.8.8 0 00-.397.69v6.267c0 .296.162.56.417.7a.794.794 0 00.856-.072l1.097-.83 1.117 1.77zm.9-3.989l-.64.183 1.553 2.473-1.075.63-1.3-2.06-.29-.46-1.635 1.237V7.68l4.717 3.084-1.33.377z"></path></g></svg>'},14345:e=>{"use strict";e.exports=p},72019:e=>{"use strict";e.exports=i},23852:e=>{"use strict";e.exports=n},92055:e=>{"use strict";e.exports=g},91524:e=>{"use strict";e.exports=h},69383:e=>{"use strict";e.exports=d},71293:e=>{"use strict";e.exports=u},68831:e=>{"use strict";e.exports=s},97878:e=>{"use strict";e.exports=c},3476:e=>{"use strict";e.exports=o},26826:e=>{"use strict";e.exports=a},48891:e=>{"use strict";e.exports=t},30726:e=>{"use strict";e.exports=r}},l={};function w(t){var a=l[t];if(void 0!==a)return a.exports;var r=l[t]={id:t,exports:{}};return e[t](r,r.exports,w),r.exports}w.n=e=>{var l=e&&e.__esModule?()=>e.default:()=>e;return w.d(l,{a:l}),l},w.d=(e,l)=>{for(var t in l)w.o(l,t)&&!w.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:l[t]})},w.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),w.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},w.p="";var b={};return w.p=window.jimuConfig.baseUrl,(()=>{"use strict";w.r(b),w.d(b,{default:()=>_e});var e=w(48891);const l={_widgetLabel:"Suitability Modeler",wro_general_back:"Back",wro_general_cancel:"Cancel",wro_general_clear:"Clear",wro_general_close:"Close",wro_general_export:"Export",wro_general_information:"Information",wro_general_loading:"Loading...",wro_general_next:"Next",wro_general_run:"Run",wro_general_save:"Save",wro_general_saveAs:"Save As",wro_general_warning:"Warning",wro_step_1:"1",wro_step_2:"2",wro_step_3:"3",wro_tabs_layers:"Layers",wro_tabs_model:"Model",wro_tabs_chart:"Chart",wro_main_modelIssue:"Model Issue",wro_main_runError:"Error running model",wro_main_caption:"Suitability Modeler",wro_main_browsePrompt:"Weighted overlay service",wro_main_selectLayersCaption:"Select layers",wro_main_selectLayers:"Layers",wro_main_designModelCaption:"Design model",wro_main_designModel:"Design model",wro_main_transparency:"Transparency",wro_main_visible:"Visible",wro_main_total:"Total",wro_main_unableToLoad:"Unable to load model.",wro_remap_label:"{name} ({minmax})",wro_saveModel_save:"Export",wro_saveModel_title:"Title",wro_saveModel_titleRequired:"Title (required)",wro_saveModel_summary:"Summary",wro_saveModel_description:"Description",wro_saveModel_tags:"Tags",wro_saveModel_folder:"Folder",wro_saveModel_homeFolderPattern:"{username} (Home)",wro_saveModel_failed:"Export failed.",wro_chart_prompt:"Features",wro_chart_generate:"Generate chart",wro_chart_working:"Updating...",wro_chart_polygonTool:"Draw a polygon",wro_chart_freehandPolygonTool:"Draw a freehand polygon",wro_chart_selectTool:"Select from a layer",wro_chart_zoomPanTool:"Pan",wro_chart_clearButton:"Clear",wro_chart_selectLayerPlaceholder:"Choose a layer",wro_chart_noSubjectLayers:"Your map has no polygon layers.",wro_chart_noModelLayer:"The model hasn't been run",wro_chart_tipPattern:"{category} - {label}: {percent}%",wro_chart_tipPattern2:"{category}: {percent}%",wro_chart_labelPattern:"{category} - {label}",wro_colorRamp_low:"Low",wro_colorRamp_high:"High",wro_colorRamp_tipPattern:"{label} ({value})",wro_colorRamp_flipCaption:"Flip",wro_colorRamp_1:"Extremely Low",wro_colorRamp_2:"Very Low",wro_colorRamp_3:"Low",wro_colorRamp_4:"Low Medium",wro_colorRamp_5:"Medium",wro_colorRamp_6:"High Medium",wro_colorRamp_7:"High",wro_colorRamp_8:"Very High",wro_colorRamp_9:"Extremely High",wro_1_9_green_yellow_red:"Green Yellow Red",wro_1_9_red_yellow_green:"Red Yellow Green",wro_1_9_yellow_to_dark_red:"Yellow to Dark Red",wro_1_9_dark_red_to_yellow:"Dark Red to Yellow",wro_1_9_light_gray_to_dark_gray:"Light Gray to Dark Gray",wro_1_9_dark_gray_to_light_gray:"Dark Gray to Light Gray",wro_1_9_light_brown_to_dark_brown:"Light Brown to Dark Brown",wro_1_9_dark_brown_to_light_brown:"Dark Brown to Light Brown",wro_1_9_full_spectrum_bright_red_to_blue:"Full Spectrum - Bright Red to Blue",wro_1_9_full_spectrum_bright_blue_to_red:"Full Spectrum - Bright Blue to Red",wro_1_9_partial_spectrum_yellow_to_blue:"Partial Spectrum - Yellow to Blue",wro_1_9_partial_spectrum_blue_to_yellow:"Partial Spectrum - Blue to Yellow",wro_1_9_yellow_green_to_dark_blue:"Yellow-Green to Dark Blue",wro_1_9_dark_blue_to_yellow_green:"Dark Blue to Yellow-Green",wro_1_9_cold_to_hot_diverging:"Cold to Hot Diverging",wro_1_9_hot_to_cold_diverging:"Hot to Cold Diverging",wro_1_9_surface_low_to_high:"Surface - Low to High",wro_1_9_surface_high_to_low:"Surface - High to Low",wro_validation_validating:"Validating...",wro_validation_invalidServiceUrl:"The weighted overlay service URL is invalid.",wro_validation_undefinedItemUrl:"This item's URL is not defined.",wro_validation_errorloadingService:"Unable to load service",wro_validation_errorLoadingItem:"Unable to load item",wro_validation_errorQueryingLayers:"Unable to query service layers",wro_validation_noLayers:"There are no modeling layers",wro_validation_noModel:"No model",wro_validation_noMap:"No map",wro_validation_notAnImageService:"This item is not an image Service",wro_validation_notAWroService:"This configured item is not a weighted overlay service",wro_validation_notAllowRasterFunction:"allowRasterFunction must be set to true",wro_validation_notNearestResampling:"defaultResamplingMethod must be Nearest",wro_validation_missingFieldPattern:"{field} is a required field",wro_validation_wroServiceNotDefined:"No weighted overlay service was configured"};var t=w(26826),a=w(30726),r=w(36811),o=w.n(r);const n=l=>{const{className:t}=l,r=function(e,l){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&l.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)l.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t}(l,["className"]),n=(0,e.classNames)("jimu-icon-component",t);return e.React.createElement(a.Icon,Object.assign({className:n,icon:o()},r))};var i=w(32373),s=w.n(i);const u=l=>{const{className:t}=l,r=function(e,l){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&l.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)l.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t}(l,["className"]),o=(0,e.classNames)("jimu-icon-component",t);return e.React.createElement(a.Icon,Object.assign({className:o,icon:s()},r))};var c=w(96314),d=w.n(c);const g=l=>{const{className:t}=l,r=function(e,l){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&l.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)l.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t}(l,["className"]),o=(0,e.classNames)("jimu-icon-component",t);return e.React.createElement(a.Icon,Object.assign({className:o,icon:d()},r))};var h=w(35384),p=w.n(h);const m=l=>{const{className:t}=l,r=function(e,l){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&l.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)l.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t}(l,["className"]),o=(0,e.classNames)("jimu-icon-component",t);return e.React.createElement(a.Icon,Object.assign({className:o,icon:p()},r))};var v=w(3476);class y extends e.React.PureComponent{constructor(l){super(l),this.initChart=e=>{return l=this,t=void 0,r=function*(){var l,t;try{let a=this.am4chartsModule;if(a||(a=this.am4chartsModule=yield v.default.loadChartsModule()),this.pieChart)try{this.pieChart.dispose(),this.pieChart=null}catch(e){console.error(e)}const{am4core:r,am4charts:o}=a,n=this.props.wroContext.getTheme();(null==n?void 0:n.darkTheme)?r.useTheme(a.am4themes_dark):r.unuseTheme(a.am4themes_dark);const i=!("rtl"!==(null===(l=null===document||void 0===document?void 0:document.documentElement)||void 0===l?void 0:l.dir)),s=null===(t=null===document||void 0===document?void 0:document.documentElement)||void 0===t?void 0:t.lang;let u="{category} {value.percent.formatNumber('#.00')}%";const c="{category}";let d="{value.percent.formatNumber('#.00')}%";"ar"===s&&(d="%{value.percent.formatNumber('#.00')}"),"tr"===s&&(u="{category} %{value.percent.formatNumber('#.00')}",d="%{value.percent.formatNumber('#.00')}");const g=r.create(this.chartRef.current,o.PieChart);g.rtl=i,g.radius=r.percent(90);const h=g.series.push(new o.PieSeries);h.dataFields.value="value",h.dataFields.category="label",h.slices.template.propertyFields.fill="fillColor",h.labels.template.disabled=!0,h.ticks.template.disabled=!0,h.slices.template.tooltipText=u,h.legendSettings.labelText=c,h.legendSettings.valueText=d;const p=g.legend=new o.Legend;p.position="bottom",p.maxHeight=130,p.maxWidth=340,p.scrollable=!0,p.layout="vertical",p.valueLabels.template.align="right",p.valueLabels.template.textAlign="end",i&&(p.reverseOrder=!0,p.itemContainers.template.reverseOrder=!0);const w=p.markers.template;w.width=15,w.height=15,e&&(g.data=e),this.pieChart=g}catch(e){console.error("Error creating chart",e)}},new((a=void 0)||(a=Promise))((function(e,o){function n(e){try{s(r.next(e))}catch(e){o(e)}}function i(e){try{s(r.throw(e))}catch(e){o(e)}}function s(l){var t;l.done?e(l.value):(t=l.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,i)}s((r=r.apply(l,t||[])).next())}));var l,t,a,r},this.chartRef=e.React.createRef(),this.state={needsRefresh:!1}}componentDidMount(){this.initChart()}componentDidUpdate(e){var l;const t=this.props.wroModel,a=e.wroModel,r=t&&"chart-panel"===t.activePanel,o=a&&"chart-panel"===a.activePanel;let n;if(e.histogramData!==this.props.histogramData){n=[];const e=this.props.histogramData;(null==e?void 0:e.colorCounts)&&e.colorCounts.length>0&&e.colorCounts.forEach((e=>{const l="rgb("+e.rgb[0].toString()+","+e.rgb[1].toString()+","+e.rgb[2].toString()+")",t={label:e.label,value:e.count,fillColor:l};n.push(t)})),this.pieChart&&(this.pieChart.data=n)}e.wroStatus.themeId!==this.props.wroStatus.themeId&&(n||(n=null===(l=this.pieChart)||void 0===l?void 0:l.data),this.initChart(n)),r&&!o&&this.state.needsRefresh&&(this.pieChart&&(this.pieChart.invalidateRawData(),this.pieChart.legend.deepInvalidate()),this.setState({needsRefresh:!1})),r||!o||this.state.needsRefresh||this.setState({needsRefresh:!0})}componentWillUnmount(){this.pieChart&&(this.pieChart.dispose(),this.pieChart=null)}render(){return(0,e.jsx)("div",{ref:this.chartRef,className:"widget-wro-chart-component"})}}var f=w(23852),_=w(72019),x=w(68831),L=function(e,l,t,a){return new(t||(t=Promise))((function(r,o){function n(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var l;e.done?r(e.value):(l=e.value,l instanceof t?l:new t((function(e){e(l)}))).then(n,i)}s((a=a.apply(e,l||[])).next())}))};function C(e,l,t,a){return L(this,void 0,void 0,(function*(){if(e.highlightHandle&&(e.highlightHandle.remove(),e.highlightHandle=null),a&&a.length>0){const r=yield l.whenLayerView(t);r&&(e.highlightHandle=r.highlight(a))}}))}function M(e){let l=null;return e&&1===e.length?l=e[0]:e&&e.length>1&&(l=new _.default({spatialReference:e[0].spatialReference}),e.forEach((e=>{e.rings&&e.rings.forEach((e=>{l.addRing(e)}))}))),l}var S=w(71293);function R(e){const l=j(e);return!!(null==l?void 0:l.renderingRule)}function j(e){const l=e.wroModel,t=e.wroContext.getView();if((null==t?void 0:t.map)&&(null==l?void 0:l.mapLayerId))return t.map.findLayerById(l.mapLayerId)}var k=w(97878);class I extends e.React.PureComponent{constructor(e){super(e),this.watchHandles=[],this.activateSketch=(e,l,t)=>{this.cancelSketch();const a="selectLayer"===e,r=this.props.wroContext.getView();if(null==r?void 0:r.map){this.setGraphicsLayerVisibility(this.drawGfxLayerId,!a);const e=a?this.selGfxLayerId:this.drawGfxLayerId,o=this.ensureGraphicsLayer(r,e),n=this.activeSketchViewModel=new k.default({view:r,layer:o});n.on("create",(e=>{if("complete"===e.state){if(a){this.clearHighlightHandle();const l=e.graphic.geometry,t=this.newTask(r,l);this.computeHistograms(t).catch((()=>{})),o.remove(e.graphic)}else{e.graphic&&(e.graphic.symbol={type:"simple-fill",color:[0,255,255,.4],style:"solid",outline:{color:[0,0,0,.6],width:1}});const l=this.newTask(r,null);this.computeHistograms(l).catch((()=>{}))}n.create(l,t)}})),n.create(l,t)}},this.cancelSketch=()=>{const e=this.activeSketchViewModel;if(e){try{e.cancel(),e.destroy()}catch(e){console.error("Error canceling SketchViewModel",e)}this.activeSketchViewModel=null}},this.canComputeHistograms=()=>R(this.props),this.clearHandles=e=>{Array.isArray(e)&&e.forEach((e=>{try{e&&e.remove()}catch(e){console.error(e)}}))},this.clearHighlightHandle=()=>{this.clearHandles([this.highlightHandle]),this.highlightHandle=null},this.computeHistograms=e=>{return l=this,t=void 0,r=function*(){const l=this.props.wroContext.nls,t=this.workingId=Date.now(),a=!!e.featureSelectionGeometry;this.setState({isWorking:!0,showWarning:!1});try{const r=yield function(e){var l;return L(this,void 0,void 0,(function*(){let t,a;if((null===(l=e.imageLayer)||void 0===l?void 0:l.renderingRule)&&(t=e.featureSelectionGeometry?yield function(e){var l;return L(this,void 0,void 0,(function*(){let t;const a=e.view,r=e.featureMapLayerId,o=e.featureSelectionGeometry,n=r&&(null===(l=null==a?void 0:a.map)||void 0===l?void 0:l.findLayerById(r));if(n&&o&&"function"==typeof n.createQuery&&"function"==typeof n.queryFeatures){C(e,a,n,null).catch((()=>{}));const l=n.createQuery();l.returnGeometry=!0,l.geometry=o;const r=yield n.queryFeatures(l);if(null==r?void 0:r.features){C(e,a,n,r.features).catch((()=>{}));const l=[];r.features.forEach((e=>{e.geometry&&l.push(e.geometry.clone())})),l.length>0&&(t=M(l))}}return t}))}(e):yield function(e){var l;return L(this,void 0,void 0,(function*(){let t;const a=e.view,r=e.graphicsMapLayerId,o=r&&(null===(l=null==a?void 0:a.map)||void 0===l?void 0:l.findLayerById(r));if(null==o?void 0:o.graphics){const e=[];o.graphics.forEach((l=>{l.geometry&&"polygon"===l.geometry.type&&e.push(l.geometry.clone())})),e.length>0&&(t=M(e))}return t}))}(e),t)){const l=yield function(e,l){return L(this,void 0,void 0,(function*(){let t;if((null==e?void 0:e.renderingRule)&&l){const a=`${e.url}/computeHistograms`,r=function(e,l){let t,a,r=0,o=0;const n=e.imageMaxWidth,i=e.imageMaxHeight,s=l.extent;r=s.width,o=s.height,r<1&&(r=1),o<1&&(o=1);const u=Math.ceil(r/n),c=Math.ceil(o/i);return t=Math.max(u,c),a={x:t,y:t},a}(e,l),o={f:"json"};o.geometry=JSON.stringify(l.toJSON()),o.geometryType="esriGeometryPolygon",o.renderingRule=JSON.stringify(e.renderingRule.toJSON()),o.pixelSize=JSON.stringify(r);const n={query:o,responseType:"json"};t=yield(0,x.default)(a,n),t=null==t?void 0:t.data}return t}))}(e.imageLayer,t);a=function(e,l){var t;const a=e.wroContext.nls,r={noDataCount:0,colorCounts:[]},o=e.imageLayer,n=null==o?void 0:o.renderingRule;if(!n||!l||!l.histograms||0===l.histograms.length)return r;const i=l.histograms[0],s=Math.round(i.min),u=Math.round(i.max)-1;0===s&&i.counts>0&&(r.noDataCount=i.counts[0]);let c=0;const d=null===(t=null==n?void 0:n.functionArguments)||void 0===t?void 0:t.Colormap;return d&&d.forEach((e=>{let l=0;const t=e[0];let o=null;const n=[e[1],e[2],e[3]];l=t<s||t>u?0:i.counts[t-s],c+=l;const d=a("wro_colorRamp_"+t.toString());d&&(o=a("wro_chart_labelPattern",{category:t.toString(),label:d})),l>0&&r.colorCounts.push({count:l,value:t,pct:0,label:o,rgb:n})})),r.noDataCount>0&&(c+=r.noDataCount),c>0&&r.colorCounts.forEach((e=>{const l=e.count/c*100;e.pct=l})),r}(e,l)}return a}))}(e);if(t===this.workingId){let t=null;(null==r?void 0:r.colorCounts)&&0===r.colorCounts.length&&(t=l("noData")),e.highlightHandle&&(this.highlightHandle=e.highlightHandle),a?(this.selGeometry=e.featureSelectionGeometry,this.setState({histogramDataSelect:r,isWorking:!1,showWarning:!!t,warning:t})):(this.selGeometry=null,this.setState({histogramDataDraw:r,isWorking:!1,showWarning:!!t,warning:t}))}}catch(e){console.error("Error computing histograms",e),t===this.workingId&&this.setState({isWorking:!1,showWarning:!0,warning:l("wro_validation_errorLoadingItem")})}},new((a=void 0)||(a=Promise))((function(e,o){function n(e){try{s(r.next(e))}catch(e){o(e)}}function i(e){try{s(r.throw(e))}catch(e){o(e)}}function s(l){var t;l.done?e(l.value):(t=l.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,i)}s((r=r.apply(l,t||[])).next())}));var l,t,a,r},this.ensureGraphicsLayer=(e,l)=>function(e,l){let t;return l&&(t=e.map.findLayerById(l)),t||(t=new f.default({id:l,title:l,listMode:"hide"}),e.map.add(t)),t}(e,l),this.getGraphicsLayer=e=>{const l=this.props.wroContext.getView();if(null==l?void 0:l.map)return l.map.findLayerById(e)},this.getImageLayer=()=>j(this.props),this.getLayers=()=>function(e){const l=[],t=e.wroContext.getView();return(null==t?void 0:t.map)&&(t.map.allLayers.forEach((e=>{"feature"===e.type&&"polygon"===e.geometryType&&l.push(e)})),l.reverse()),l}(this.props),this.handleClearClicked=()=>{const e=this.getGraphicsLayer(this.drawGfxLayerId);e&&e.removeAll(),this.clearHighlightHandle(),this.setState({histogramDataDraw:null,histogramDataSelect:null,showWarning:!1})},this.handleDrawPolygonClicked=()=>{this.clearHighlightHandle(),this.activateSketch("drawPolygon","polygon"),this.setState({activeTool:"drawPolygon",histogramDataSelect:null,showWarning:!1,zoomPanActive:!1})},this.handleDrawFreehandPolygonClicked=()=>{this.clearHighlightHandle(),this.activateSketch("drawFreehandPolygon","polygon",{mode:"freehand"}),this.setState({activeTool:"drawFreehandPolygon",histogramDataSelect:null,showWarning:!1,zoomPanActive:!1})},this.handleMapLayerSelected=e=>{let l=e.target.value;"string"==typeof l&&0!==l.length||(l=null),l!==this.state.selectedMapLayerId&&this.clearHighlightHandle(),this.setState({selectedMapLayerId:l,showWarning:!1,histogramDataSelect:null})},this.handleSelectLayerClicked=()=>{this.activateSketch("selectLayer","rectangle"),this.setState({activeTool:"selectLayer",showWarning:!1,zoomPanActive:!1})},this.handleZoomPanClicked=()=>{this.watchImageLayer(),this.cancelSketch(),this.setState({showWarning:!1,zoomPanActive:!0})},this.newTask=(e,l)=>{const t=function(e,l,t,a,r,o){return{wroContext:e,view:l,imageLayer:t,featureMapLayerId:a,featureSelectionGeometry:r,graphicsMapLayerId:o}}(this.props.wroContext,e,this.getImageLayer(),this.state.selectedMapLayerId,l,this.drawGfxLayerId);return t},this.resetState=()=>{this.cancelSketch(),this.clearHighlightHandle(),this.setState({activeTool:null,histogramDataDraw:null,histogramDataSelect:null,isWorking:!1,selectedMapLayerId:null,showWarning:!1,warning:null,zoomPanActive:!0})},this.setGraphicsLayerVisibility=(e,l)=>{const t=this.getGraphicsLayer(e);t&&(t.visible=l)},this.handlePanelClicked=()=>{const e=this.props.wroContext.modelController,l=this.props.wroModel;l&&e.setActivePanel(l,"model-panel")};const l=this.props.wroContext.getId();this.drawGfxLayerId=`${l}_drawGfxLayerId`,this.selGfxLayerId=`${l}_selGfxLayerId`,this.state={activeTool:null,histogramDataDraw:null,histogramDataSelect:null,isWorking:!1,selectedMapLayerId:null,showWarning:!1,warning:null,zoomPanActive:!0}}componentDidUpdate(e,l){const t=this.props.wroModel,a=e.wroModel,r=t&&"chart-panel"===t.activePanel,o=a&&"chart-panel"===a.activePanel;!r&&this.activeSketchViewModel&&this.cancelSketch();const n=null==t?void 0:t.mapLayerId,i=null==a?void 0:a.mapLayerId;if(i&&n!==i&&this.unwatchImageLayer(),n&&n!==i&&this.watchImageLayer(),e.wroStatus.viewId!==this.props.wroStatus.viewId)this.resetState(),this.watchView();else if(this.canComputeHistograms()){if(r&&!o&&!this.state.zoomPanActive){const e=this.state.activeTool;"drawPolygon"===e?this.activateSketch("drawPolygon","polygon"):"drawFreehandPolygon"===e?this.activateSketch("drawFreehandPolygon","polygon",{mode:"freehand"}):"selectLayer"===e&&this.activateSketch("selectLayer","rectangle"),this.setState({showWarning:!1})}}else this.resetState(),this.watchImageLayer()}componentWillUnmount(){this.cancelSketch(),this.unwatchView()}unwatchImageLayer(){this.imageLayerHandle&&(this.clearHandles([this.imageLayerHandle]),this.imageLayerHandle=null)}unwatchView(){this.unwatchImageLayer(),this.clearHighlightHandle(),this.clearHandles(this.watchHandles),this.watchHandles=[]}watchImageLayer(){this.unwatchImageLayer();const e=this.getImageLayer();e&&"function"==typeof e.watch&&(this.imageLayerHandle=e.watch("renderingRule",((e,l,t,a)=>{const r=()=>{const e=this.props.wroContext.getView();if(this.state.histogramDataDraw){const l=this.newTask(e,null);this.computeHistograms(l).catch((()=>{}))}},o=this.props.wroContext.getView();if(this.state.histogramDataSelect&&this.selGeometry){const e=this.newTask(o,this.selGeometry);this.computeHistograms(e).then((()=>{r()})).catch((()=>{}))}else r()})))}watchView(){this.unwatchView(),this.watchImageLayer();const e=this.props.wroContext.getView();if(null==e?void 0:e.map){const l=e.map.allLayers.on("change",(l=>{const t=this.state.selectedMapLayerId;t&&(e.map.findLayerById(t)||this.setState({selectedMapLayerId:null}))}));this.watchHandles.push(l)}}render(){const l=this.props.wroContext.nls,t=this.props.wroModel,{activeTool:r,isWorking:o,selectedMapLayerId:i,zoomPanActive:s}=this.state,c=this.canComputeHistograms();let d;if(c){if(c&&(null==t?void 0:t.mapLayerId)){const t=this.getLayers();if("selectLayer"===r)if(t&&t.length>0){const r=[];t.forEach((l=>{const t=(0,e.jsx)("option",{key:l.id,value:l.id},l.title);r.push(t)})),d=(0,e.jsx)(a.Select,{placeholder:l("wro_chart_selectLayerPlaceholder"),value:i,onChange:this.handleMapLayerSelected},r)}else d=(0,e.jsx)("span",{className:"widget-wro-chart-note"},l("wro_chart_noSubjectLayers"))}}else d=(0,e.jsx)("span",{className:"widget-wro-chart-note"},l("wro_chart_noModelLayer"));const h=!!d;let p=(0,e.jsx)("div",{className:"widget-wro-chart-working"}," ");return o?p=(0,e.jsx)("div",{className:"widget-wro-chart-working"},(0,e.jsx)("span",null,l("wro_chart_working"))):this.state.showWarning&&this.state.warning&&(p=(0,e.jsx)("div",{className:"widget-wro-chart-warning"},this.state.warning)),(0,e.jsx)("div",{className:"widget-wro-chart-panel"},(0,e.jsx)("div",{className:"widget-wro-chart-header"},(0,e.jsx)("div",{className:"widget-wro-flex-between"},(0,e.jsx)("span",{className:"widget-wro-chart-features-label"},l("wro_chart_prompt")),(0,e.jsx)(a.ButtonGroup,{className:"widget-wro-chart-tools"},(0,e.jsx)("span",{className:"working","data-dojo-attach-point":"workingNode"}),(0,e.jsx)(a.Button,{className:"widget-wro-chart-button",active:!s&&"drawPolygon"===r,disabled:!c,icon:!0,title:l("wro_chart_polygonTool"),onClick:this.handleDrawPolygonClicked},(0,e.jsx)(n,{size:"m"})),(0,e.jsx)(a.Button,{className:"widget-wro-chart-button",active:!s&&"drawFreehandPolygon"===r,disabled:!c,icon:!0,title:l("wro_chart_freehandPolygonTool"),onClick:this.handleDrawFreehandPolygonClicked},(0,e.jsx)(u,{size:"m"})),(0,e.jsx)(a.Button,{className:"widget-wro-chart-button",active:!s&&"selectLayer"===r,disabled:!c,icon:!0,title:l("wro_chart_selectTool"),onClick:this.handleSelectLayerClicked},(0,e.jsx)(g,{size:"m"})),(0,e.jsx)(a.Button,{className:"widget-wro-chart-button",active:s,disabled:!c,icon:!0,title:l("wro_chart_zoomPanTool"),onClick:this.handleZoomPanClicked},(0,e.jsx)(m,{size:"m"})),(0,e.jsx)(a.Button,{className:"widget-wro-chart-button",disabled:!c,type:"link",onClick:this.handleClearClicked},l("wro_general_clear")))),h&&(0,e.jsx)("div",{className:"widget-wro-chart-select-layer-section"},d),p),(0,e.jsx)("div",{className:"widget-wro-chart-body"},this.renderChart()))}renderChart(){const l=this.props.wroContext,t=this.props.wroModel,a=this.props.wroStatus;let r;return r="selectLayer"===this.state.activeTool?this.state.histogramDataSelect:this.state.histogramDataDraw,(0,e.jsx)(y,{histogramData:r,wroContext:l,wroModel:t,wroStatus:a})}}class N extends e.React.PureComponent{constructor(){super(...arguments),this.handlePanelClicked=()=>{const e=this.props.wroContext.modelController,l=this.props.wroModel;l&&e.setActivePanel(l,"model-panel")}}render(){const l=this.props.wroContext.nls,t=this.props.wroModel,a=null==t?void 0:t.loadErrors,r=null==t?void 0:t.rasterLayers,o=!!this.props.wroStatus.viewId;let n=[];if(this.props.wroStatus.isModelLoading)n=[(0,e.jsx)("li",{key:"loading",className:"widget-wro-loading-msg"},l("wro_general_loading"))];else if(a&&a.length>0)a.forEach((l=>{n.push((0,e.jsx)("li",{key:l.message,className:"widget-wro-loading-error-msg"},l.message))}));else if(t)r&&0!==r.length?r&&r.length>0&&r.forEach((e=>{const l=this.renderLayer(e,t);n.push(l)})):n=[(0,e.jsx)("li",{key:"noLayers",className:"widget-wro-loading-error-msg"},l("wro_validation_noLayers"))];else{let t="wro_validation_noModel";o||(t="wro_validation_noMap"),n=[(0,e.jsx)("li",{key:"noMap",className:"widget-wro-loading-error-msg widget-wro-fadein"},l(t))]}return(0,e.jsx)("div",{className:"widget-wro-layers-panel"},(0,e.jsx)("div",{className:"widget-wro-layers-body"},(0,e.jsx)("ul",{className:"widget-wro-layers-list"},n),(0,e.jsx)("div",{className:"widget-wro-layers-footer"})))}renderLayer(l,t){const r=this.props.wroContext.modelController,o=l.title,n=r.isLayerSelected(t,l.rasterLayerId);return(0,e.jsx)("li",{key:l.name},(0,e.jsx)(a.Label,null,(0,e.jsx)(a.Checkbox,{checked:n,onChange:(e,a)=>{e&&r.selectLayer(t,l.rasterLayerId,!!a)}}),(0,e.jsx)("span",{className:"widget-wro-layer-title"},o)))}}var P=w(77799),O=w.n(P);let D,T=!1;function E(e){let l;return D&&D.some((t=>(e===t.name&&(l=t),!!l))),l}function V(){return D||(D=[{name:"1_9_green_yellow_red",label:null,colors:[{label:null,value:1,rgb:[38,115,0]},{label:null,value:2,rgb:[86,148,0]},{label:null,value:3,rgb:[39,181,0]},{label:null,value:4,rgb:[197,219,0]},{label:null,value:5,rgb:[255,255,0]},{label:null,value:6,rgb:[255,195,0]},{label:null,value:7,rgb:[250,142,0]},{label:null,value:8,rgb:[242,85,0]},{label:null,value:9,rgb:[230,0,0]}]},{name:"1_9_red_yellow_green",label:null,colors:[{label:null,value:1,rgb:[230,0,0]},{label:null,value:2,rgb:[242,85,0]},{label:null,value:3,rgb:[250,142,0]},{label:null,value:4,rgb:[255,195,0]},{label:null,value:5,rgb:[255,255,0]},{label:null,value:6,rgb:[197,219,0]},{label:null,value:7,rgb:[39,181,0]},{label:null,value:8,rgb:[86,148,0]},{label:null,value:9,rgb:[38,115,0]}]},{name:"1_9_yellow_to_dark_red",label:null,colors:[{label:null,value:1,rgb:[255,255,128]},{label:null,value:2,rgb:[252,233,106]},{label:null,value:3,rgb:[250,209,85]},{label:null,value:4,rgb:[247,190,67]},{label:null,value:5,rgb:[242,167,46]},{label:null,value:6,rgb:[207,122,31]},{label:null,value:7,rgb:[173,83,19]},{label:null,value:8,rgb:[138,46,10]},{label:null,value:9,rgb:[107,0,0]}]},{name:"1_9_dark_red_to_yellow",label:null,colors:[{label:null,value:1,rgb:[107,0,0]},{label:null,value:2,rgb:[138,46,10]},{label:null,value:3,rgb:[173,83,19]},{label:null,value:4,rgb:[207,122,31]},{label:null,value:5,rgb:[242,167,46]},{label:null,value:6,rgb:[247,190,67]},{label:null,value:7,rgb:[250,209,85]},{label:null,value:8,rgb:[252,233,106]},{label:null,value:9,rgb:[255,255,128]}]},{name:"1_9_light_gray_to_dark_gray",label:null,colors:[{label:null,value:1,rgb:[219,219,219]},{label:null,value:2,rgb:[196,196,196]},{label:null,value:3,rgb:[176,176,176]},{label:null,value:4,rgb:[156,156,156]},{label:null,value:5,rgb:[135,135,135]},{label:null,value:6,rgb:[117,117,117]},{label:null,value:7,rgb:[99,99,99]},{label:null,value:8,rgb:[84,84,84]},{label:null,value:9,rgb:[69,69,69]}]},{name:"1_9_dark_gray_to_light_gray",label:null,colors:[{label:null,value:1,rgb:[69,69,69]},{label:null,value:2,rgb:[84,84,84]},{label:null,value:3,rgb:[99,99,99]},{label:null,value:4,rgb:[117,117,117]},{label:null,value:5,rgb:[135,135,135]},{label:null,value:6,rgb:[156,156,156]},{label:null,value:7,rgb:[176,176,176]},{label:null,value:8,rgb:[196,196,196]},{label:null,value:9,rgb:[219,219,219]}]},{name:"1_9_light_brown_to_dark_brown",label:null,colors:[{label:null,value:1,rgb:[250,233,212]},{label:null,value:2,rgb:[242,208,184]},{label:null,value:3,rgb:[235,187,160]},{label:null,value:4,rgb:[224,163,135]},{label:null,value:5,rgb:[217,144,113]},{label:null,value:6,rgb:[207,124,91]},{label:null,value:7,rgb:[194,103,70]},{label:null,value:8,rgb:[184,84,53]},{label:null,value:9,rgb:[171,65,36]}]},{name:"1_9_dark_brown_to_light_brown",label:null,colors:[{label:null,value:1,rgb:[171,65,36]},{label:null,value:2,rgb:[184,84,53]},{label:null,value:3,rgb:[194,103,70]},{label:null,value:4,rgb:[207,124,91]},{label:null,value:5,rgb:[217,144,113]},{label:null,value:6,rgb:[224,163,135]},{label:null,value:7,rgb:[235,187,160]},{label:null,value:8,rgb:[242,208,184]},{label:null,value:9,rgb:[250,233,212]}]},{name:"1_9_full_spectrum_bright_red_to_blue",label:null,colors:[{label:null,value:1,rgb:[255,0,0]},{label:null,value:2,rgb:[255,119,0]},{label:null,value:3,rgb:[255,200,0]},{label:null,value:4,rgb:[238,255,56]},{label:null,value:5,rgb:[182,255,143]},{label:null,value:6,rgb:[89,255,225]},{label:null,value:7,rgb:[51,194,255]},{label:null,value:8,rgb:[56,106,255]},{label:null,value:9,rgb:[0,0,255]}]},{name:"1_9_full_spectrum_bright_blue_to_red",label:null,colors:[{label:null,value:1,rgb:[0,0,255]},{label:null,value:2,rgb:[56,106,255]},{label:null,value:3,rgb:[51,194,255]},{label:null,value:4,rgb:[89,255,225]},{label:null,value:5,rgb:[182,255,143]},{label:null,value:6,rgb:[238,255,56]},{label:null,value:7,rgb:[255,200,0]},{label:null,value:8,rgb:[255,119,0]},{label:null,value:9,rgb:[255,0,0]}]},{name:"1_9_partial_spectrum_yellow_to_blue",label:null,colors:[{label:null,value:1,rgb:[242,241,162]},{label:null,value:2,rgb:[252,250,98]},{label:null,value:3,rgb:[255,255,0]},{label:null,value:4,rgb:[255,149,0]},{label:null,value:5,rgb:[255,0,0]},{label:null,value:6,rgb:[245,5,189]},{label:null,value:7,rgb:[176,7,237]},{label:null,value:8,rgb:[99,24,204]},{label:null,value:9,rgb:[7,29,173]}]},{name:"1_9_partial_spectrum_blue_to_yellow",label:null,colors:[{label:null,value:1,rgb:[7,29,173]},{label:null,value:2,rgb:[99,24,204]},{label:null,value:3,rgb:[176,7,237]},{label:null,value:4,rgb:[245,5,189]},{label:null,value:5,rgb:[255,0,0]},{label:null,value:6,rgb:[255,149,0]},{label:null,value:7,rgb:[255,255,0]},{label:null,value:8,rgb:[252,250,98]},{label:null,value:9,rgb:[242,241,162]}]},{name:"1_9_yellow_green_to_dark_blue",label:null,colors:[{label:null,value:1,rgb:[255,255,128]},{label:null,value:2,rgb:[182,245,88]},{label:null,value:3,rgb:[113,235,47]},{label:null,value:4,rgb:[59,214,45]},{label:null,value:5,rgb:[61,184,104]},{label:null,value:6,rgb:[42,156,154]},{label:null,value:7,rgb:[33,110,158]},{label:null,value:8,rgb:[31,62,140]},{label:null,value:9,rgb:[12,16,120]}]},{name:"1_9_dark_blue_to_yellow_green",label:null,colors:[{label:null,value:1,rgb:[12,16,120]},{label:null,value:2,rgb:[31,62,140]},{label:null,value:3,rgb:[33,110,158]},{label:null,value:4,rgb:[42,156,154]},{label:null,value:5,rgb:[61,184,104]},{label:null,value:6,rgb:[59,214,45]},{label:null,value:7,rgb:[113,235,47]},{label:null,value:8,rgb:[182,245,88]},{label:null,value:9,rgb:[255,255,128]}]},{name:"1_9_cold_to_hot_diverging",label:null,colors:[{label:null,value:1,rgb:[40,146,199]},{label:null,value:2,rgb:[109,169,179]},{label:null,value:3,rgb:[160,194,155]},{label:null,value:4,rgb:[206,222,129]},{label:null,value:5,rgb:[250,250,100]},{label:null,value:6,rgb:[252,196,76]},{label:null,value:7,rgb:[250,141,52]},{label:null,value:8,rgb:[242,89,34]},{label:null,value:9,rgb:[232,16,20]}]},{name:"1_9_hot_to_cold_diverging",label:null,colors:[{label:null,value:1,rgb:[232,16,20]},{label:null,value:2,rgb:[242,89,34]},{label:null,value:3,rgb:[250,141,52]},{label:null,value:4,rgb:[252,196,76]},{label:null,value:5,rgb:[250,250,100]},{label:null,value:6,rgb:[206,222,129]},{label:null,value:7,rgb:[160,194,155]},{label:null,value:8,rgb:[109,169,179]},{label:null,value:9,rgb:[40,146,199]}]},{name:"1_9_surface_low_to_high",label:null,colors:[{label:null,value:1,rgb:[112,153,89]},{label:null,value:2,rgb:[176,196,124]},{label:null,value:3,rgb:[242,238,162]},{label:null,value:4,rgb:[242,224,150]},{label:null,value:5,rgb:[242,206,133]},{label:null,value:6,rgb:[217,169,130]},{label:null,value:7,rgb:[194,140,124]},{label:null,value:8,rgb:[255,184,193]},{label:null,value:9,rgb:[255,242,255]}]},{name:"1_9_surface_high_to_low",label:null,colors:[{label:null,value:1,rgb:[255,242,255]},{label:null,value:2,rgb:[255,184,193]},{label:null,value:3,rgb:[194,140,124]},{label:null,value:4,rgb:[217,169,130]},{label:null,value:5,rgb:[242,206,133]},{label:null,value:6,rgb:[242,224,150]},{label:null,value:7,rgb:[242,238,162]},{label:null,value:8,rgb:[176,196,124]},{label:null,value:9,rgb:[112,153,89]}]}]),D}class A extends e.React.PureComponent{render(){const l=this.props.lowLabel,t=this.props.highLabel,a=[],r=E(this.props.defName);r&&r.colors.forEach((e=>{a.push(this.renderColor(e))}));const o=e.css`
      margin: 0 6px;
    `;return(0,e.jsx)("div",{className:"widget-wro-color-ramp"},(0,e.jsx)("span",{css:o},l),(0,e.jsx)("span",null,a),(0,e.jsx)("span",{css:o},t))}renderColor(l){let t=null,a=l.label;const r=l.value.toString();a&&(a=a.trim()),a&&a.length>0&&r&&r.length>0?t=this.props.nls("wro_colorRamp_tipPattern",{label:a,value:r}):a&&a.length>0?t=a:r&&r.length>0&&(t=r);const o=l.rgb,n={backgroundColor:"rgb("+o[0].toString()+","+o[1].toString()+","+o[2].toString()+")"};return(0,e.jsx)("span",{key:l.value.toString(),className:"widget-wro-color-ramp-color",style:n,title:t})}}class H extends e.React.PureComponent{render(){const l=this.props.wroContext.nls,t=this.props.wroModel,r=this.props.wroContext.modelController,o=l("wro_colorRamp_low"),n=l("wro_colorRamp_high");let i;const s=null==t?void 0:t.colormapName;if(s){const l=E(s);l&&(i=(0,e.jsx)(A,{defName:l.name,lowLabel:o,highLabel:n,nls:this.props.wroContext.nls}))}const u=[],c=V();return t&&c&&c.forEach((l=>{u.push((0,e.jsx)(a.DropdownItem,{key:l.name,onClick:()=>{r.setColormapName(t,l.name)}},(0,e.jsx)(A,{defName:l.name,lowLabel:o,highLabel:n,nls:this.props.wroContext.nls})))})),(0,e.jsx)("div",{className:"widget-wro-colormap-selector"},(0,e.jsx)(a.Dropdown,null,(0,e.jsx)(a.DropdownButton,null,i),(0,e.jsx)(a.DropdownMenu,{className:"widget-wro-color-dropdown-menu"},u)))}}class F{clear(e){return(e=U.cloneModel(e)).colormapName="1_9_green_yellow_red",e.modelLayers&&e.modelLayers.forEach((l=>{l.selected=!1,l.remapOpen=!1,l.weight=null;const t=U.findRasterLayer(e,l.rasterLayerId);(null==t?void 0:t.remapRanges)&&(l.remapRanges=U.cloneRemapRanges(t.remapRanges))})),e.activePanel="layers-panel",this.onModelChange(e,!0),e}isLayerSelected(e,l){const t=U.findModelLayer(e,l);return!!(null==t?void 0:t.selected)}isValid(e){let l=0;return(null==e?void 0:e.modelLayers)&&e.modelLayers.forEach((e=>{e.selected&&"number"==typeof e.weight&&(l+=e.weight)})),100===l}onModelChange(e,l){}onStatusChange(e){}selectLayer(e,l,t){e=U.cloneModel(e);const a=U.findModelLayer(e,l);if(a&&!t){const t=U.findRasterLayer(e,l);(null==t?void 0:t.remapRanges)&&(a.remapRanges=U.cloneRemapRanges(t.remapRanges)),a.remapOpen=!1,a.weight=null}return a&&(a.selected=!!t),this.onModelChange(e),e}setActivePanel(e,l){return(e=U.cloneModel(e)).activePanel=l,this.onModelChange(e),e}setColormapName(e,l){return(e=U.cloneModel(e)).colormapName=l,this.onModelChange(e),e}setMapLayerId(e,l){return(e=U.cloneModel(e)).mapLayerId=l,this.onModelChange(e),e}setRemapOpen(e,l,t){e=U.cloneModel(e);const a=U.findModelLayer(e,l);return a&&(a.remapOpen=!!t),this.onModelChange(e),e}setRemapOutputValue(e,l,t,a){e=U.cloneModel(e);const r=U.findModelLayer(e,l);return r&&(r.remapRanges[t].outputValue=a),this.onModelChange(e),e}setWeight(e,l,t){e=U.cloneModel(e);const a=U.findModelLayer(e,l);return a&&(a.weight=t),this.onModelChange(e),e}}class U{static cloneModel(e){return JSON.parse(JSON.stringify(e))}static cloneRasterLayers(e){return JSON.parse(JSON.stringify(e))}static cloneRemapRanges(e){return JSON.parse(JSON.stringify(e))}static cloneStatus(e){return JSON.parse(JSON.stringify(e))}static findModelLayer(e,l){let t;return e.modelLayers&&e.modelLayers.some((e=>(e.rasterLayerId===l&&(t=e),!!t))),t}static findRasterLayer(e,l){let t;return e.rasterLayers&&e.rasterLayers.some((e=>(e.rasterLayerId===l&&(t=e),!!t))),t}static initModel(e,l){const t=this.newWroModel();return t.serviceUrl=e.serviceUrl,l&&l.length>0&&(t.loadErrors=JSON.parse(JSON.stringify(l))),(null==e?void 0:e.rasterLayers)&&(t.rasterLayers=this.cloneRasterLayers(e.rasterLayers),t.rasterLayers.forEach((e=>{const l=this.newModelLayer();l.rasterLayerId=e.rasterLayerId,l.title=e.title,e.remapRanges&&(l.remapRanges=this.cloneRemapRanges(e.remapRanges)),l.remapRanges&&l.remapRanges.length>0&&t.modelLayers.push(l)}))),t}static newIssue(){return{detail:null,message:null}}static newModelLayer(){return{rasterLayerId:null,remapOpen:!1,remapRanges:[],selected:!1,title:null,weight:null}}static newRasterLayer(){return{metadata:null,name:null,rasterLayerId:null,remapRanges:[],title:null,url:null}}static newRemapRange(){return{inputMax:null,inputMin:null,label:null,originalOutputValue:null,outputValue:null}}static newWroModel(){return{activePanel:null,colormapName:"1_9_green_yellow_red",loadErrors:[],mapLayerId:null,modelLayers:[],rasterLayers:[],serviceUrl:null}}static newWroStatus(){return{activePanel:null,isModelLoading:!1,isModelRunning:!1,themeId:null,viewId:null}}}function B(e,l){l||(l={});const t={rasterFunction:"Local",rasterFunctionArguments:{Operation:e,ExtentType:0,CellsizeType:1,Rasters:l.rasters||[]}};return l.outputPixelType&&(t.outputPixelType=l.outputPixelType),t}function G(e,l,t,a){const r=[];let o,n,i,s=!1;return a&&(o=a.labels,n=a.noDataLabels,i=a.sortBy),Array.isArray(e)&&Array.isArray(l)&&e.length===2*l.length&&(s=Array.isArray(o)&&o.length===l.length,l.forEach(((l,t)=>{const a=2*t,n=U.newRemapRange();n.label=null,n.inputMin=e[a],n.inputMax=e[a+1],n.outputValue=l,n.originalOutputValue=l,n.label=s?o[t]:W(n.inputMin,n.inputMax),r.push(n)}))),Array.isArray(t)&&t.length>0&&(s=Array.isArray(n)&&n.length===t.length/2,t.forEach(((e,l)=>{if(l%2==0){const a=U.newRemapRange();a.label=null,a.inputMin=e,a.inputMax=t[l+1],a.outputValue=0,a.originalOutputValue=0,a.label=s?n[l]:W(a.inputMin,a.inputMax),r.push(a)}}))),r.length>0?(i&&r.sort(((e,l)=>e[i]<l[i]?-1:e[i]>l[i]?1:0)),r):void 0}function W(e,l){return e===l?`${e}`:`${e} - ${l}`}function z(e){let l;const t=e.modelLayers.filter((e=>!!(e.selected&&"number"==typeof e.weight&&e.weight>0))).map((e=>{const l=function(e){if(!e)return;const l={},t=[],a=[],r=[],o=[],n=[],i=!0,s="InputRanges",u="OutputValues",c="NoDataRanges",d="Labels",g="NoDataLabels";return e.forEach((e=>{const l=e.label||W(e.inputMin,e.inputMax);e.outputValue?(t.push(e.inputMin),t.push(e.inputMax),a.push(e.outputValue),o.push(l)):(r.push(e.inputMin),r.push(e.inputMax),n.push(l))})),a.length>0&&(l[s]=t,l[u]=a,i&&(l[d]=o)),r.length>0&&(l[c]=r,i&&(l[g]=n)),l}(e.remapRanges);return l.Raster="$"+e.rasterLayerId.toString(),l.weight=e.weight/100,l})),a=E(e.colormapName);a&&(l=a.colors.map((e=>[e.value].concat(e.rgb))));const r=function(e,l){const t=e.map((e=>{const l=function(e){return e||(e={}),{rasterFunction:"Remap",rasterFunctionArguments:{Raster:e.Raster||"$$",UseTable:!1,InputRanges:e.InputRanges||[],OutputValues:e.OutputValues||[],NoDataRanges:e.NoDataRanges||[],AllowUnmatched:!0}}}(e);return B(3,{rasters:[l,e.weight]})})),a=B(55,{rasters:t});return function(e){return e||(e={}),{rasterFunction:"Colormap",rasterFunctionArguments:{Raster:e.raster||"$$",Colormap:e.colormap||[]}}}({raster:B(49,{rasters:[a],outputPixelType:"U8"}),colormap:l})}(t,l);return r}var J=w(69383);class $ extends e.React.PureComponent{constructor(e){super(e),this.home="__home__",this.chk=e=>"string"==typeof e&&(e=e.trim()).length>0?e:null,this.close=()=>{this.props.close&&this.props.close()},this.exportModel=()=>{const e=this.portal,l=this.itemData,t=this.serviceUrl,{title:a,summary:r,description:o,tags:n,folder:i}=this.state;if(!e||!e.user||!a)return;const s={title:a,summary:r,description:o,tags:n,itemData:l,portal:e,serviceUrl:t};i!==this.home&&(s.folder=i),this.props.exportModel&&this.props.exportModel(s),this.close()},this.handleDescriptionChange=e=>{const l=this.chk(e.target.value);this.setState({description:l})},this.handleFolderChange=e=>{const l=this.chk(e.target.value);this.setState({folder:l})},this.handleSummaryChange=e=>{const l=this.chk(e.target.value);this.setState({summary:l})},this.handleTagsChange=e=>{const l=this.chk(e.target.value);this.setState({tags:l})},this.handleTitleChange=e=>{const l=this.chk(e.target.value);this.setState({title:l,hasTitle:!!l})},this._handleToggle=e=>{e?this.exportModel():this.close()},this.init=()=>{return e=this,l=void 0,a=function*(){try{const e=this.props.wroModel;this.serviceUrl=e.serviceUrl,this.itemData=function(e){const l=z(e);if(l)return{renderingRule:l}}(e);const l=[],t=this.props.wroContext.getPortalUrl(),a=new J.default({url:t});if(yield a.load(),a.user){this.portal=a;const e=yield a.user.fetchFolders();e&&e.forEach((e=>{l.push({id:e.id,title:e.title})}))}l.length>0&&this.setState({folders:l,hasPortal:!!a.user})}catch(e){console.error(e)}},new((t=void 0)||(t=Promise))((function(r,o){function n(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var l;e.done?r(e.value):(l=e.value,l instanceof t?l:new t((function(e){e(l)}))).then(n,i)}s((a=a.apply(e,l||[])).next())}));var e,l,t,a},this.state={title:null,summary:null,description:null,tags:null,folder:this.home,folders:null,hasPortal:!1,hasTitle:!1}}componentDidMount(){this.init().catch((()=>{}))}render(){const l=this.props.wroContext.nls,t=this.state.title?"widget-wro-valid-modal":"widget-wro-invalid-modal";return(0,e.jsx)("div",null,(0,e.jsx)(a.AlertPopup,{className:`widget-wro-export-popup ${t}`,isOpen:!0,okLabel:l("wro_general_export"),title:l("wro_general_export"),toggle:this._handleToggle},this.renderForm()))}renderForm(){const l=this.props.wroContext.nls,t=this.props.wroContext.getId()+"_export",r=this.props.wroContext.getUser(),o=(null==r?void 0:r.username)||"",n=!!this.state.title,i=this.home,s=[],u=l("wro_saveModel_homeFolderPattern",{username:o});s.push((0,e.jsx)("option",{key:i,value:i},u));const c=this.state.folders;c&&c.forEach((l=>{s.push((0,e.jsx)("option",{key:l.id,value:l.id},l.title))}));let d="wro_saveModel_title";return n||(d="wro_saveModel_titleRequired"),(0,e.jsx)(a.Form,{className:"widget-wro-form"},(0,e.jsx)(a.FormGroup,null,(0,e.jsx)(a.Label,{for:t+"_title"},l(d)),(0,e.jsx)(a.TextInput,{id:t+"_title",type:"text",onChange:this.handleTitleChange})),(0,e.jsx)(a.FormGroup,null,(0,e.jsx)(a.Label,{for:t+"_summary"},l("wro_saveModel_summary")),(0,e.jsx)(a.TextInput,{id:t+"_summary",type:"text",onChange:this.handleSummaryChange})),(0,e.jsx)(a.FormGroup,null,(0,e.jsx)(a.Label,{for:t+"_description"},l("wro_saveModel_description")),(0,e.jsx)(a.TextArea,{id:t+"_description",onChange:this.handleDescriptionChange})),(0,e.jsx)(a.FormGroup,null,(0,e.jsx)(a.Label,{for:t+"_tags"},l("wro_saveModel_tags")),(0,e.jsx)(a.TextInput,{id:t+"_tags",type:"text",defaultValue:"weightedOverlayModel, geodesign",onChange:this.handleTagsChange})),(0,e.jsx)(a.FormGroup,null,(0,e.jsx)(a.Label,{for:t+"_folder"},l("wro_saveModel_folder")),(0,e.jsx)(a.Select,{id:t+"_folder",defaultValue:i,onChange:this.handleFolderChange},s)))}}class q extends e.React.PureComponent{render(){const l=this.props.wroModel,t=this.props.modelLayer,a=[],r=null==t?void 0:t.remapRanges;return r&&r.forEach(((e,r)=>{a.push(this.renderRange(e,r,t,l))})),(0,e.jsx)("div",{className:"widget-wro-remap-panel"},a)}renderRange(l,t,r,o){const n=this.props.wroContext.nls,i=this.props.wroContext.modelController,s="remap_"+r.rasterLayerId.toString()+"_"+t.toString();let u;u=l.inputMin===l.inputMax?`${l.inputMin}`:`${l.inputMin} - ${l.inputMax}`;const c=n("wro_remap_label",{name:l.label,minmax:u}),d=e.css`
      white-space: nowrap;
    `;return(0,e.jsx)("div",{key:s+"_item",className:"widget-wro-remap-range"},(0,e.jsx)("div",{className:"widget-wro-remap-range-label",title:c},c),(0,e.jsx)("div",{key:s+"_inputSection",css:d},(0,e.jsx)(a.Slider,{key:s+"_slider",className:"widget-wro-remap-slider",min:0,max:9,step:1,value:l.outputValue,onChange:e=>{const l=parseInt(e.target.value);i.setRemapOutputValue(o,r.rasterLayerId,t,l)}}),(0,e.jsx)(a.NumericInput,{key:s+"_input",className:"widget-wro-remap-numeric-input",size:"sm",min:0,max:9,precision:0,showHandlers:!1,value:l.outputValue,onChange:e=>{"number"==typeof e&&i.setRemapOutputValue(o,r.rasterLayerId,t,e)}})))}}var Y=w(92055),Z=w(91524);function Q(e,l){var t;return l&&(null===(t=null==e?void 0:e.map)||void 0===t?void 0:t.findLayerById(l))}function K(e,l){return t=this,a=void 0,o=function*(){const t=e.getView();if(null==t?void 0:t.map){const a=z(l),r=Z.default.fromJSON(a);let o=Q(t,l.mapLayerId);return o?(o.renderingRule=r,o.visible||(o.visible=!0),e.modelController.setMapLayerId(l,o.id)):(o=new Y.default({renderingRule:r,url:l.serviceUrl}),yield o.load(),t.map.add(o,0),e.modelController.setMapLayerId(l,o.id)),o}},new((r=void 0)||(r=Promise))((function(e,l){function n(e){try{s(o.next(e))}catch(e){l(e)}}function i(e){try{s(o.throw(e))}catch(e){l(e)}}function s(l){var t;l.done?e(l.value):(t=l.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,i)}s((o=o.apply(t,a||[])).next())}));var t,a,r,o}var X=w(14345),ee=function(e,l,t,a){return new(t||(t=Promise))((function(r,o){function n(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var l;e.done?r(e.value):(l=e.value,l instanceof t?l:new t((function(e){e(l)}))).then(n,i)}s((a=a.apply(e,l||[])).next())}))};class le extends e.React.PureComponent{constructor(e){super(e),this.handleClearClicked=()=>{const e=this.props.wroContext,l=this.props.wroContext.modelController,t=this.props.wroModel;t&&(function(e,l){const t=e.getView();if(null==t?void 0:t.map){const e=Q(t,l.mapLayerId);e&&(e.visible=!1,e.renderingRule=null)}}(e,t),l.clear(t))},this.closeAlert=()=>{this.setState({alertMessage:null})},this.closeExport=()=>{this.setState({showExport:!1})},this.exportModel=e=>ee(this,void 0,void 0,(function*(){if(this.state.isExporting)return;this.setState({isExporting:!0});const l=this.props.wroContext.nls;try{yield function(e){return l=this,t=void 0,r=function*(){const{title:l,summary:t,description:a,tags:r,folder:o}=e,{itemData:n,portal:i,serviceUrl:s}=e;let u=[];"string"==typeof r&&(u=r.split(",").filter((e=>e.length>0))),0===u.length&&(u=["weightedOverlayModel"]);const c={item:new S.default({type:"Image Service",typeKeywords:["geodesignModelerLayer"],title:l,snippet:t,description:a,tags:u,url:s})};n&&(c.data=JSON.stringify(n)),o&&(c.folder=o),yield i.user.addItem(c)},new((a=void 0)||(a=Promise))((function(e,o){function n(e){try{s(r.next(e))}catch(e){o(e)}}function i(e){try{s(r.throw(e))}catch(e){o(e)}}function s(l){var t;l.done?e(l.value):(t=l.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,i)}s((r=r.apply(l,t||[])).next())}));var l,t,a,r}(e),this.setState({isExporting:!1})}catch(e){console.error(e),console.error("Error exporting WRO model",e);const t=(null==e?void 0:e.message)||l("wro_saveModel_failed");this.setState({isExporting:!1,alertMessage:t})}})),this.handleExportClicked=()=>{this.state.isRunning||this.state.isExporting||this.runModel(!0).catch((()=>{}))},this.handleLayersPanelClicked=()=>{const e=this.props.wroContext.modelController,l=this.props.wroModel;l&&e.setActivePanel(l,"layers-panel")},this.handleChartPanelClicked=()=>{const e=this.props.wroContext.modelController,l=this.props.wroModel;l&&e.setActivePanel(l,"chart-panel")},this.handleRunClicked=()=>{this.state.isRunning||this.runModel(!1).catch((()=>{}))},this.runModel=e=>ee(this,void 0,void 0,(function*(){if(this.state.isRunning)return;const l=this.props.wroContext.nls,t=this.props.wroContext,a=this.props.wroModel;if(a){this.setState({isRunning:!0,isLayerRefreshing:!0});try{const l={isRunning:!1,isLayerRefreshing:!1},r=yield K(t,a);if(r){const e=t.getView();e&&(l.isLayerRefreshing=!0,e.whenLayerView(r).then((e=>{X.default.whenFalseOnce(e,"updating",(()=>{this.setState({isLayerRefreshing:!1})}))})))}e&&(l.showExport=!0),this.setState(l)}catch(e){console.error("Error running WRO model",e);const t=(null==e?void 0:e.message)||l("wro_main_runError");this.setState({isRunning:!1,isLayerRefreshing:!1,alertMessage:t})}}})),this.state={alertMessage:null,isExporting:!1,isLayerRefreshing:!1,isRunning:!1,showExport:!1}}render(){const l=this.props.wroContext.nls,t=this.props.wroContext,r=this.props.wroModel,o=this.props.wroStatus,n=null==r?void 0:r.modelLayers,i=[];let s;n&&n.forEach((e=>{if(e.selected){const l=this.renderLayer(e,r);i.push(l)}}));const u=this.state.alertMessage;let c;return u&&(s=(0,e.jsx)(a.AlertPopup,{isOpen:!0,hideOK:!0,cancelLabel:l("wro_general_close"),title:l("wro_main_modelIssue"),toggle:this.closeAlert},(0,e.jsx)("div",{style:{fontSize:"small",minWidth:"300px"}},u))),this.state.showExport&&(c=(0,e.jsx)($,{wroContext:t,wroModel:r,wroStatus:o,close:this.closeExport,exportModel:this.exportModel})),(0,e.jsx)("div",{className:"widget-wro-model-panel"},(0,e.jsx)("div",{className:"widget-wro-panel-header widget-wro-flex-between"},(0,e.jsx)("div",null,(0,e.jsx)("span",null,l("wro_main_designModelCaption")),s,c),(0,e.jsx)(H,{wroContext:t,wroModel:r,wroStatus:o})),(0,e.jsx)("div",{className:"widget-wro-model-panel-body"},(0,e.jsx)("ul",{className:"widget-wro-model-layers-list"},i),(0,e.jsx)("div",{className:"widget-wro-model-footer"},this.renderTotal(),this.renderButtons())))}renderButtons(){const l=this.props.wroContext.nls,t=this.props.wroContext.modelController,r=this.props.wroModel,{isExporting:o,isRunning:n}=this.state,i=!!this.props.wroStatus.viewId,s=!!r,u=[];let c=!1;r&&(c=t.isValid(r));let d=!1;const g=!!this.props.wroContext.getConfig().allowExport,h=this.props.wroContext.getUser();return g&&h&&h.privileges&&-1!==h.privileges.indexOf("portal:user:createItem")&&(d=!0),u.push((0,e.jsx)(a.Button,{key:"clear",disabled:!s,onClick:this.handleClearClicked},l("wro_general_clear"))),d&&u.push((0,e.jsx)(a.Button,{key:"export",disabled:!c||!i||n||o,onClick:this.handleExportClicked},l("wro_general_export"))),u.push((0,e.jsx)(a.Button,{key:"run",type:"primary",disabled:!c||!i||n,onClick:this.handleRunClicked},l("wro_general_run"))),(0,e.jsx)("div",null,(0,e.jsx)("div",{className:"widget-wro-model-buttons"},(0,e.jsx)("div",{className:"widget-wro-flex-between widget-wro-flex-column"},(0,e.jsx)(a.ButtonGroup,null,u))))}renderLayer(l,t){const r=this.props.wroContext.modelController,o=this.props.wroContext,n=this.props.wroStatus,i="layer_"+l.rasterLayerId.toString();let s,u=l.weight;return"number"!=typeof u&&(u=0),l.remapOpen&&(s=(0,e.jsx)(q,{modelLayer:l,wroContext:o,wroModel:t,wroStatus:n})),(0,e.jsx)("li",{key:i+"_li"},(0,e.jsx)("div",{key:i+"_item",className:"widget-wro-model-item"},(0,e.jsx)("div",{className:"widget-wro-model-item-label"},l.title),(0,e.jsx)("div",{key:i+"_section",className:"widget-wro-model-item-input-section"},(0,e.jsx)(a.Button,{size:"sm",icon:!0,active:l.remapOpen,className:"widget-wro-model-item-remap-btn",onClick:()=>{r.setRemapOpen(t,l.rasterLayerId,!l.remapOpen)}},(0,e.jsx)(a.Icon,{icon:O()})),(0,e.jsx)(a.NumericInput,{key:i+"_input",className:"widget-wro-input-weight",size:"sm",min:0,max:100,precision:0,showHandlers:!1,defaultValue:u,onChange:e=>{"number"!=typeof e&&(e=null),r.setWeight(t,l.rasterLayerId,e)}}),(0,e.jsx)("span",{className:"widget-wro-model-item-percent"},"%"))),s)}renderTotal(){var l;const t=this.props.wroContext.nls,a=this.props.wroModel,r=!!this.props.wroStatus.viewId,{isRunning:o,isLayerRefreshing:n}=this.state,i=null===(l=null===document||void 0===document?void 0:document.documentElement)||void 0===l?void 0:l.lang;let s=0;const u=null==a?void 0:a.modelLayers;u&&u.forEach((e=>{e.selected&&"number"==typeof e.weight&&(s+=e.weight)}));let c=s.toString()+"%";"ar"!==i&&"tr"!==i||(c="%"+s.toString());const d=this.props.wroContext.getTheme();let g,h;return g=100===s?e.css`
        background-color: ${d.colors.palette.success[100]};
      `:e.css`
        background-color: ${d.colors.palette.danger[100]};
      `,r?(o||n)&&(h=(0,e.jsx)("span",{className:"widget-wro-model-working"},t("wro_chart_working"))):h=(0,e.jsx)("span",{className:"widget-wro-chart-note"},t("wro_validation_noMap")),(0,e.jsx)("div",{className:"widget-wro-model-total",css:g},(0,e.jsx)("span",null,t("wro_main_total")),h,(0,e.jsx)("span",null,c))}}class te extends e.React.PureComponent{constructor(l){super(l),this.canEnableChart=()=>R(this.props),this.canEnableDesignModel=()=>{const e=this.props.wroModel;let l=!1;return(null==e?void 0:e.modelLayers)&&(l=e.modelLayers.some((e=>!!e.selected))),l},this.chartPanelRef=e.React.createRef()}componentDidUpdate(e){const l=this.props.wroContext.modelController,t=this.props.wroModel;if(t&&e.wroModel!==t){const e=t.activePanel;("model-panel"!==e||this.canEnableDesignModel())&&("chart-panel"!==e||this.canEnableChart())||l.setActivePanel(t,"layers-panel")}}render(){const l=this.props.wroContext.nls,t=this.props.wroContext.modelController,r=this.props.wroContext,o=this.props.wroModel,n=this.props.wroStatus,i=!!o,s=(null==o?void 0:o.activePanel)||"layers-panel",u=!this.canEnableDesignModel(),c=!this.canEnableChart();return(0,e.jsx)("div",{className:"widget-wro-modeler"},(0,e.jsx)("h4",{className:"widget-wro-header",style:{display:this.props.wroContext.getLabel()?"block":"none"}},this.props.wroContext.getLabel()),(0,e.jsx)("div",{className:"widget-wro-body"},(0,e.jsx)(a.Tabs,{className:"widget-wro-tabs",value:s,onChange:e=>{o&&t.setActivePanel(o,e)},type:"underline"},(0,e.jsx)(a.Tab,{id:"layers-panel",title:l("wro_main_selectLayersCaption")},(0,e.jsx)(N,{wroContext:r,wroModel:o,wroStatus:n})),(0,e.jsx)(a.Tab,{id:"model-panel",title:l("wro_main_designModelCaption"),disabled:!i||u},(0,e.jsx)(le,{wroContext:r,wroModel:o,wroStatus:n})),(0,e.jsx)(a.Tab,{id:"chart-panel",title:l("wro_chart_generate"),disabled:!i||c},(0,e.jsx)(I,{ref:this.chartPanelRef,wroContext:r,wroModel:o,wroStatus:n})))))}}var ae=function(e,l,t,a){return new(t||(t=Promise))((function(r,o){function n(e){try{s(a.next(e))}catch(e){o(e)}}function i(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var l;e.done?r(e.value):(l=e.value,l instanceof t?l:new t((function(e){e(l)}))).then(n,i)}s((a=a.apply(e,l||[])).next())}))};class re{checkMixedContent(e){return"string"==typeof window.location.href&&0===window.location.href.indexOf("https://")&&"string"==typeof e&&0===e.indexOf("http://")&&(e="https:"+e.substring(5)),e}loadModel(e,l,t){return ae(this,void 0,void 0,(function*(){const a=e.nls,r=[];let o,n=U.newWroModel(),i=null;t="string"==typeof t?t.trim():null;const s=(e,l)=>{const t=U.newIssue();t.message=e,(null==l?void 0:l.message)&&(t.detail=l.message),r.push(t)};if((l="string"==typeof l?l.trim():null)||t||0!==r.length||s(a("wro_validation_wroServiceNotDefined")),!l&&t&&0===r.length){this.itemId=t,i=new S.default({id:t});try{yield i.load()}catch(e){console.error("Error loading item",t,e),s(a("wro_validation_errorLoadingItem"),e)}if(0===r.length&&(!this.serviceTitle&&i.title&&(this.serviceTitle=i.title),(l="string"==typeof i.url?i.url.trim():null)||s(a("wro_validation_undefinedItemUrl"))),0===r.length)try{const e=yield i.fetchData("json");o=null==e?void 0:e.renderingRule}catch(e){console.error("Error fetching item data",t,e),s(a("wro_validation_errorLoadingItem"),e)}}if(l&&0===r.length){if(this.serviceUrl=this.checkMixedContent(l),0!==this.serviceUrl.indexOf("http://")&&0!==this.serviceUrl.indexOf("https://"))s(a("wro_validation_invalidServiceUrl"));else try{new URL(this.serviceUrl)||s(a("wro_validation_invalidServiceUrl"))}catch(e){s(a("wro_validation_invalidServiceUrl"))}if(0===r.length)try{this.serviceJson=yield this.readServiceJson(this.serviceUrl),!this.serviceTitle&&this.serviceJson&&this.serviceJson.name&&(this.serviceTitle=this.serviceJson.name)}catch(e){console.error("Error loading service",this.serviceUrl,e),s(a("wro_validation_errorloadingService"),e)}if(0===r.length&&function(e,l,t){const a=(e,l)=>{const a=U.newIssue();a.message=e,(null==l?void 0:l.message)&&(a.detail=l.message),t.push(a)};if(!(l.currentVersion>=10.3&&l.rasterTypeInfos))return void a(e("wro_validation_notAWroService"));l.allowRasterFunction||a(e("wro_validation_notAllowRasterFunction")),"Nearest"!==l.defaultResamplingMethod&&a(e("wro_validation_notNearestResampling"));const r=l.fields||[];["Title","Url","Description","InputRanges","OutputValues","NoDataRanges","RangeLabels","NoDataRangeLabels"].forEach((l=>{if(!r.some((e=>l===e.name))){const t=e("wro_validation_missingFieldPattern",{field:l});a(t)}}))}(e.nls,this.serviceJson,r),0===r.length)try{yield this.queryRasters(this.serviceUrl)}catch(e){console.error("Error querying mosaic",this.serviceUrl,e),s(a("wro_validation_errorQueryingLayers"),e)}}const u=this.rasterLayers&&this.rasterLayers.length>0;return 0!==r.length||u||s(a("wro_validation_noLayers")),n=U.initModel(this,r),o&&0===r.length&&function(e,l){let t,a,r=l;if(t=r.rasterFunctionArguments,"Colormap"===r.rasterFunction){const e=t.Colormap;e&&(a=function(e){let l;return D&&D.some((t=>(t.colors.every(((l,t)=>{let a=!1;const r=[l.value].concat(l.rgb),o=e[t];return r&&o&&r.length===o.length&&(a=r.every(((e,l)=>e===o[l]))),a}))&&(l=t.name),!!l))),l}(e)),r=t.Raster,t=r.rasterFunctionArguments}"Local"===r.rasterFunction&&49===t.Operation?(r=t.Rasters[0],t=r.rasterFunctionArguments):"Local"===r.rasterFunction&&48===t.Operation&&(t.Operation=49,r=t.Rasters[0],t=r.rasterFunctionArguments),"Local"===r.rasterFunction&&55===t.Operation&&t.Rasters&&(t.Rasters.map((l=>{var t;if(null===(t=null==l?void 0:l.rasterFunctionArguments)||void 0===t?void 0:t.Rasters){const t={};return l.rasterFunctionArguments.Rasters.forEach((l=>{if(isNaN(l)){t.id=parseInt(l.rasterFunctionArguments.Raster.substr(1),10);const a=U.findRasterLayer(e,t.id);t.remapRanges=function(e){let l;if(e){const t={inputRangesArgumentName:"InputRanges",outputValuesArgumentName:"OutputValues",noDataRangesArgumentName:"NoDataRanges",labelsArgumentName:"Labels",noDataLabelsArgumentName:"NoDataLabels"};l=G(e[t.inputRangesArgumentName],e[t.outputValuesArgumentName],e[t.noDataRangesArgumentName],{labels:e[t.labelsArgumentName],noDataLabels:e[t.noDataLabelsArgumentName],sortBy:"inputMin"})}return l}(l.rasterFunctionArguments),(null==a?void 0:a.remapRanges)&&a.remapRanges.forEach(((e,l)=>{const a=t.remapRanges[l];a&&(a.label=e.label)}))}else t.weight=100*l})),t}return null})).forEach((l=>{if(l&&"number"==typeof l.id&&"number"==typeof l.weight&&l.weight>0&&l.weight<=100){const t=U.findModelLayer(e,l.id);t&&(t.selected=!0,t.weight=l.weight,l.remapRanges&&(t.remapRanges=l.remapRanges))}})),a&&(e.colormapName=a))}(n,o),n}))}queryRasters(e){return ae(this,void 0,void 0,(function*(){e+="/query";return(0,x.default)(e,{query:{f:"json",where:"1=1",outFields:["*"],returnGeometry:!1},responseType:"json"}).then((e=>{var l;const t=null===(l=null==e?void 0:e.data)||void 0===l?void 0:l.features;if(t&&t.length>0&&t[0].attributes){const e="Title";t.sort(((l,t)=>l.attributes[e]<t.attributes[e]?-1:l.attributes[e]>t.attributes[e]?1:0));const l=[];t.forEach((e=>{const t=function(e){try{if(e.attributes&&"ForestFragmentation_US_USFS_2002"===e.attributes.Name&&"Forest Fragmentation"===e.attributes.Title&&49===e.attributes.OBJECTID)return null}catch(e){}const l=e.attributes;let t,a,r,o,n,i;return l&&(i=U.newRasterLayer(),i.rasterLayerId=l.OBJECTID,i.name=l.Name,i.title=l.Title,i.url=l.Url,i.metadata=l.Metadata,l.InputRanges&&"string"==typeof l.InputRanges&&l.OutputValues&&"string"==typeof l.OutputValues&&(t=l.InputRanges.split(",").map((e=>parseFloat(e.trim()))),a=l.OutputValues.split(",").map((e=>parseInt(e.trim(),10))),l.RangeLabels&&"string"==typeof l.RangeLabels&&(o=l.RangeLabels.split(",").map((e=>e.trim())))),l.NoDataRanges&&"string"==typeof l.NoDataRanges&&(r=l.NoDataRanges.split(",").map((e=>parseFloat(e.trim()))),l.NoDataRangeLabels&&"string"==typeof l.NoDataRangeLabels&&(n=l.NoDataRangeLabels.split(",").map((e=>e.trim())))),i.remapRanges=G(t,a,r,{labels:o,noDataLabels:n,sortBy:"inputMin"})),i}(e);t&&(t.url=this.checkMixedContent(t.url),l.push(t))})),this.rasterLayers=l}}))}))}readServiceJson(e){return ae(this,void 0,void 0,(function*(){return(0,x.default)(e,{query:{f:"json"},responseType:"json"}).then((e=>null==e?void 0:e.data))}))}}class oe{constructor(){this.modelController=new F,this.getConfig=()=>{},this.getId=()=>null,this.getLabel=()=>null,this.getPortal=()=>{},this.getPortalUrl=()=>null,this.getTheme=()=>{},this.getUser=()=>{},this.getView=()=>{}}loadModel(e,l){return t=this,a=void 0,o=function*(){const t=new re;return yield t.loadModel(this,e,l)},new((r=void 0)||(r=Promise))((function(e,l){function n(e){try{s(o.next(e))}catch(e){l(e)}}function i(e){try{s(o.throw(e))}catch(e){l(e)}}function s(l){var t;l.done?e(l.value):(t=l.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,i)}s((o=o.apply(t,a||[])).next())}));var t,a,r,o}nls(e,l){return e}}var ne=w(93379),ie=w.n(ne),se=w(7795),ue=w.n(se),ce=w(90569),de=w.n(ce),ge=w(3565),he=w.n(ge),pe=w(19216),we=w.n(pe),be=w(44589),me=w.n(be),ve=w(51623),ye={};ye.styleTagTransform=me(),ye.setAttributes=he(),ye.insert=de().bind(null,"head"),ye.domAPI=ue(),ye.insertStyleElement=we(),ie()(ve.Z,ye),ve.Z&&ve.Z.locals&&ve.Z.locals;let fe=0;class _e extends e.React.PureComponent{constructor(t){super(t),this.autoRunModel=e=>{var l;const t=this.wroContext,a=this.state.wroModel,r=this.state.jimuMapView;(null===(l=null==r?void 0:r.view)||void 0===l?void 0:l.map)&&a&&(a.mapLayerId||e)&&t.modelController.isValid(a)&&K(t,a).then((()=>{})).catch((e=>{console.error("Error running WRO model",e)}))},this.clearLayers=(e,l)=>{const t=this.wroContext,a=this.props.id;if(null==e?void 0:e.map){let r=e.map.findLayerById(`${a}_drawGfxLayerId`);r&&e.map.remove(r),r=e.map.findLayerById(`${a}_selGfxLayerId`),r&&e.map.remove(r),(null==l?void 0:l.mapLayerId)&&function(e,l){const t=e.getView();if(null==t?void 0:t.map){const e=Q(t,l.mapLayerId);e&&t.map.remove(e)}}(t,l)}},this.handleActiveViewChange=e=>{var l;const t=this.state.wroModel,a=this.state.jimuMapView;(null===(l=null==a?void 0:a.view)||void 0===l?void 0:l.map)&&this.clearLayers(null==a?void 0:a.view,t);const r=U.cloneStatus(this.state.wroStatus);r.viewId=e?this.newViewId():null,this.setState({jimuMapView:e,wroStatus:r},(()=>{}))},this.newThemeId=()=>"themeId_"+(fe++).toString(),this.newViewId=()=>"viewId_"+(fe++).toString(),this.nls=(e,t)=>this.props.intl?this.props.intl.formatMessage({id:e,defaultMessage:l[e]},t):e,this.onWroModelChange=(e,l)=>{var t,a,r,o;try{if(l){const e=null===(o=null===(r=null===(a=null===(t=this.modelerRef)||void 0===t?void 0:t.current)||void 0===a?void 0:a.chartPanelRef)||void 0===r?void 0:r.current)||void 0===o?void 0:o.handleClearClicked;e&&e()}}catch(e){console.error(e)}this.setState({wroModel:e})},this.onWroStatusChange=e=>{this.setState({wroStatus:e})},this.modelerRef=e.React.createRef();const a=U.newWroStatus();var r;this.state={jimuMapView:null,wasModelLoaded:!1,wroModel:null,wroStatus:a},r=this.nls,T||(D||(D=[{name:"1_9_green_yellow_red",label:null,colors:[{label:null,value:1,rgb:[38,115,0]},{label:null,value:2,rgb:[86,148,0]},{label:null,value:3,rgb:[39,181,0]},{label:null,value:4,rgb:[197,219,0]},{label:null,value:5,rgb:[255,255,0]},{label:null,value:6,rgb:[255,195,0]},{label:null,value:7,rgb:[250,142,0]},{label:null,value:8,rgb:[242,85,0]},{label:null,value:9,rgb:[230,0,0]}]},{name:"1_9_red_yellow_green",label:null,colors:[{label:null,value:1,rgb:[230,0,0]},{label:null,value:2,rgb:[242,85,0]},{label:null,value:3,rgb:[250,142,0]},{label:null,value:4,rgb:[255,195,0]},{label:null,value:5,rgb:[255,255,0]},{label:null,value:6,rgb:[197,219,0]},{label:null,value:7,rgb:[39,181,0]},{label:null,value:8,rgb:[86,148,0]},{label:null,value:9,rgb:[38,115,0]}]},{name:"1_9_yellow_to_dark_red",label:null,colors:[{label:null,value:1,rgb:[255,255,128]},{label:null,value:2,rgb:[252,233,106]},{label:null,value:3,rgb:[250,209,85]},{label:null,value:4,rgb:[247,190,67]},{label:null,value:5,rgb:[242,167,46]},{label:null,value:6,rgb:[207,122,31]},{label:null,value:7,rgb:[173,83,19]},{label:null,value:8,rgb:[138,46,10]},{label:null,value:9,rgb:[107,0,0]}]},{name:"1_9_dark_red_to_yellow",label:null,colors:[{label:null,value:1,rgb:[107,0,0]},{label:null,value:2,rgb:[138,46,10]},{label:null,value:3,rgb:[173,83,19]},{label:null,value:4,rgb:[207,122,31]},{label:null,value:5,rgb:[242,167,46]},{label:null,value:6,rgb:[247,190,67]},{label:null,value:7,rgb:[250,209,85]},{label:null,value:8,rgb:[252,233,106]},{label:null,value:9,rgb:[255,255,128]}]},{name:"1_9_light_gray_to_dark_gray",label:null,colors:[{label:null,value:1,rgb:[219,219,219]},{label:null,value:2,rgb:[196,196,196]},{label:null,value:3,rgb:[176,176,176]},{label:null,value:4,rgb:[156,156,156]},{label:null,value:5,rgb:[135,135,135]},{label:null,value:6,rgb:[117,117,117]},{label:null,value:7,rgb:[99,99,99]},{label:null,value:8,rgb:[84,84,84]},{label:null,value:9,rgb:[69,69,69]}]},{name:"1_9_dark_gray_to_light_gray",label:null,colors:[{label:null,value:1,rgb:[69,69,69]},{label:null,value:2,rgb:[84,84,84]},{label:null,value:3,rgb:[99,99,99]},{label:null,value:4,rgb:[117,117,117]},{label:null,value:5,rgb:[135,135,135]},{label:null,value:6,rgb:[156,156,156]},{label:null,value:7,rgb:[176,176,176]},{label:null,value:8,rgb:[196,196,196]},{label:null,value:9,rgb:[219,219,219]}]},{name:"1_9_light_brown_to_dark_brown",label:null,colors:[{label:null,value:1,rgb:[250,233,212]},{label:null,value:2,rgb:[242,208,184]},{label:null,value:3,rgb:[235,187,160]},{label:null,value:4,rgb:[224,163,135]},{label:null,value:5,rgb:[217,144,113]},{label:null,value:6,rgb:[207,124,91]},{label:null,value:7,rgb:[194,103,70]},{label:null,value:8,rgb:[184,84,53]},{label:null,value:9,rgb:[171,65,36]}]},{name:"1_9_dark_brown_to_light_brown",label:null,colors:[{label:null,value:1,rgb:[171,65,36]},{label:null,value:2,rgb:[184,84,53]},{label:null,value:3,rgb:[194,103,70]},{label:null,value:4,rgb:[207,124,91]},{label:null,value:5,rgb:[217,144,113]},{label:null,value:6,rgb:[224,163,135]},{label:null,value:7,rgb:[235,187,160]},{label:null,value:8,rgb:[242,208,184]},{label:null,value:9,rgb:[250,233,212]}]},{name:"1_9_full_spectrum_bright_red_to_blue",label:null,colors:[{label:null,value:1,rgb:[255,0,0]},{label:null,value:2,rgb:[255,119,0]},{label:null,value:3,rgb:[255,200,0]},{label:null,value:4,rgb:[238,255,56]},{label:null,value:5,rgb:[182,255,143]},{label:null,value:6,rgb:[89,255,225]},{label:null,value:7,rgb:[51,194,255]},{label:null,value:8,rgb:[56,106,255]},{label:null,value:9,rgb:[0,0,255]}]},{name:"1_9_full_spectrum_bright_blue_to_red",label:null,colors:[{label:null,value:1,rgb:[0,0,255]},{label:null,value:2,rgb:[56,106,255]},{label:null,value:3,rgb:[51,194,255]},{label:null,value:4,rgb:[89,255,225]},{label:null,value:5,rgb:[182,255,143]},{label:null,value:6,rgb:[238,255,56]},{label:null,value:7,rgb:[255,200,0]},{label:null,value:8,rgb:[255,119,0]},{label:null,value:9,rgb:[255,0,0]}]},{name:"1_9_partial_spectrum_yellow_to_blue",label:null,colors:[{label:null,value:1,rgb:[242,241,162]},{label:null,value:2,rgb:[252,250,98]},{label:null,value:3,rgb:[255,255,0]},{label:null,value:4,rgb:[255,149,0]},{label:null,value:5,rgb:[255,0,0]},{label:null,value:6,rgb:[245,5,189]},{label:null,value:7,rgb:[176,7,237]},{label:null,value:8,rgb:[99,24,204]},{label:null,value:9,rgb:[7,29,173]}]},{name:"1_9_partial_spectrum_blue_to_yellow",label:null,colors:[{label:null,value:1,rgb:[7,29,173]},{label:null,value:2,rgb:[99,24,204]},{label:null,value:3,rgb:[176,7,237]},{label:null,value:4,rgb:[245,5,189]},{label:null,value:5,rgb:[255,0,0]},{label:null,value:6,rgb:[255,149,0]},{label:null,value:7,rgb:[255,255,0]},{label:null,value:8,rgb:[252,250,98]},{label:null,value:9,rgb:[242,241,162]}]},{name:"1_9_yellow_green_to_dark_blue",label:null,colors:[{label:null,value:1,rgb:[255,255,128]},{label:null,value:2,rgb:[182,245,88]},{label:null,value:3,rgb:[113,235,47]},{label:null,value:4,rgb:[59,214,45]},{label:null,value:5,rgb:[61,184,104]},{label:null,value:6,rgb:[42,156,154]},{label:null,value:7,rgb:[33,110,158]},{label:null,value:8,rgb:[31,62,140]},{label:null,value:9,rgb:[12,16,120]}]},{name:"1_9_dark_blue_to_yellow_green",label:null,colors:[{label:null,value:1,rgb:[12,16,120]},{label:null,value:2,rgb:[31,62,140]},{label:null,value:3,rgb:[33,110,158]},{label:null,value:4,rgb:[42,156,154]},{label:null,value:5,rgb:[61,184,104]},{label:null,value:6,rgb:[59,214,45]},{label:null,value:7,rgb:[113,235,47]},{label:null,value:8,rgb:[182,245,88]},{label:null,value:9,rgb:[255,255,128]}]},{name:"1_9_cold_to_hot_diverging",label:null,colors:[{label:null,value:1,rgb:[40,146,199]},{label:null,value:2,rgb:[109,169,179]},{label:null,value:3,rgb:[160,194,155]},{label:null,value:4,rgb:[206,222,129]},{label:null,value:5,rgb:[250,250,100]},{label:null,value:6,rgb:[252,196,76]},{label:null,value:7,rgb:[250,141,52]},{label:null,value:8,rgb:[242,89,34]},{label:null,value:9,rgb:[232,16,20]}]},{name:"1_9_hot_to_cold_diverging",label:null,colors:[{label:null,value:1,rgb:[232,16,20]},{label:null,value:2,rgb:[242,89,34]},{label:null,value:3,rgb:[250,141,52]},{label:null,value:4,rgb:[252,196,76]},{label:null,value:5,rgb:[250,250,100]},{label:null,value:6,rgb:[206,222,129]},{label:null,value:7,rgb:[160,194,155]},{label:null,value:8,rgb:[109,169,179]},{label:null,value:9,rgb:[40,146,199]}]},{name:"1_9_surface_low_to_high",label:null,colors:[{label:null,value:1,rgb:[112,153,89]},{label:null,value:2,rgb:[176,196,124]},{label:null,value:3,rgb:[242,238,162]},{label:null,value:4,rgb:[242,224,150]},{label:null,value:5,rgb:[242,206,133]},{label:null,value:6,rgb:[217,169,130]},{label:null,value:7,rgb:[194,140,124]},{label:null,value:8,rgb:[255,184,193]},{label:null,value:9,rgb:[255,242,255]}]},{name:"1_9_surface_high_to_low",label:null,colors:[{label:null,value:1,rgb:[255,242,255]},{label:null,value:2,rgb:[255,184,193]},{label:null,value:3,rgb:[194,140,124]},{label:null,value:4,rgb:[217,169,130]},{label:null,value:5,rgb:[242,206,133]},{label:null,value:6,rgb:[242,224,150]},{label:null,value:7,rgb:[242,238,162]},{label:null,value:8,rgb:[176,196,124]},{label:null,value:9,rgb:[112,153,89]}]}]),D.forEach((e=>{e.label=r("wro_"+e.name)||e.name,e.colors.forEach((e=>{e.label=r("wro_colorRamp_"+e.value.toString())||""+e.value.toString()}))})),T=!0);const o=this.wroContext=new oe;o.nls=this.nls,o.getConfig=()=>this.props.config,o.getId=()=>this.props.id,o.getLabel=()=>this.props.config.displayLabel?this.props.label:null,o.getPortal=()=>this.props.portalSelf,o.getPortalUrl=()=>this.props.portalUrl,o.getTheme=()=>this.props.theme,o.getUser=()=>this.props.user,o.getView=()=>{var e;return null===(e=this.state.jimuMapView)||void 0===e?void 0:e.view},o.modelController.onModelChange=this.onWroModelChange,o.modelController.onStatusChange=this.onWroStatusChange}componentDidUpdate(e,l){var t,a;const r=this.wroContext,o=this.state.wroModel,n=this.state,i=this.props,s=i.config,u=e.config,c=s.serviceUrl,d=s.itemId,g=u.serviceUrl,h=u.itemId;let p;const w=()=>(void 0===p&&(p={}),p),b=()=>(w(),p.wroStatus||(p.wroStatus=U.cloneStatus(n.wroStatus)),p.wroStatus);if(i.theme!==e.theme&&(b().themeId=this.newThemeId()),i.label!==e.label&&b(),s.displayLabel!==u.displayLabel&&b(),s.allowExport!==u.allowExport&&b(),!c&&!d)return this.clearLayers(null===(t=n.jimuMapView)||void 0===t?void 0:t.view,o),w().wroModel=null,void this.setState(p);let m=!0;if((g&&g===c||h&&h===d)&&(m=!1),!n.jimuMapView||l.jimuMapView||n.wasModelLoaded||(m=!0),m)this.clearLayers(null===(a=n.jimuMapView)||void 0===a?void 0:a.view,o),b().isModelLoading=!0,w().wroModel=null,this.setState(p),this.loadModel(r,c,d,!0);else{p&&this.setState(p);const e=n.jimuMapView;if(e&&e!==l.jimuMapView&&n.wasModelLoaded&&o&&o.mapLayerId){const e=!0;this.autoRunModel(e)}}}componentWillUnmount(){var e;const l=null===(e=this.state.jimuMapView)||void 0===e?void 0:e.view,t=this.state.wroModel;this.clearLayers(l,t)}loadModel(e,l,t,a){e.loadModel(l,t).then((e=>{const l=e,t=U.cloneStatus(this.state.wroStatus);t.isModelLoading=!1,this.setState({wasModelLoaded:!0,wroModel:l,wroStatus:t},(()=>{a&&this.autoRunModel(a)}))})).catch((e=>{console.error("Error loading WRO model",e);const l=U.cloneStatus(this.state.wroStatus);l.isModelLoading=!1,this.setState({wroStatus:l})}))}render(){var l;const a=this.wroContext,r=this.state.wroModel,o=this.state.wroStatus;return(0,e.jsx)("div",{className:"widget-wro jimu-widget"},(0,e.jsx)(te,{ref:this.modelerRef,wroContext:a,wroModel:r,wroStatus:o}),(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null===(l=this.props.useMapWidgetIds)||void 0===l?void 0:l[0],onActiveViewChange:this.handleActiveViewChange}))}}})(),b})())}}}));